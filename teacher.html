<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>单词大师训练营 - 教师端</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js">
    <style>
        /* ==================== 基础样式 ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        :root {
            --teacher-primary: #4F6AF5;
            --teacher-dark: #3a56d1;
            --teacher-light: #667eea;
            --accent: #06D6A0;
            --accent-dark: #05c593;
            --secondary: #FFD166;
            --danger: #EF476F;
            --success: #06D6A0;
            --warning: #FFD166;
            --light: #F8F9FA;
            --dark: #212529;
            --gray: #6C757D;
            --gray-light: #E9ECEF;
            --gray-lighter: #f8f9fa;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 8px 40px rgba(0, 0, 0, 0.12);
            --border-radius: 12px;
            --border-radius-sm: 8px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            background: linear-gradient(135deg, var(--teacher-light) 0%, var(--teacher-primary) 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--dark);
        }

        /* ==================== 主容器 ==================== */
        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            display: flex;
            min-height: calc(100vh - 40px);
        }

        /* ==================== 侧边栏 ==================== */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, var(--teacher-primary) 0%, var(--teacher-dark) 100%);
            color: white;
            padding: 30px 20px;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 10;
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 60%, rgba(255,255,255,0.1));
            pointer-events: none;
        }

        .user-info {
            text-align: center;
            padding-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.15);
            margin-bottom: 30px;
            position: relative;
        }

        .avatar {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            margin: 0 auto 15px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            transition: var(--transition);
        }

        .avatar:hover {
            transform: scale(1.05);
            background: rgba(255, 255, 255, 0.25);
        }

        .user-name {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .user-role {
            font-size: 14px;
            opacity: 0.9;
            background: rgba(255, 255, 255, 0.15);
            padding: 4px 12px;
            border-radius: 12px;
            display: inline-block;
            backdrop-filter: blur(10px);
        }

        /* ==================== 导航菜单 ==================== */
        .nav-menu {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 20px;
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            border-radius: var(--border-radius-sm);
            margin-bottom: 5px;
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: white;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateX(5px);
        }

        .nav-item:hover::before {
            transform: translateX(0);
        }

        .nav-item.active {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .nav-item.active::before {
            transform: translateX(0);
        }

        .nav-item i {
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        .nav-item span {
            flex: 1;
            font-weight: 500;
        }

        .nav-badge {
            background: var(--accent);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 600;
        }

        .logout-btn {
            margin-top: auto;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* ==================== 主内容区 ==================== */
        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            background: var(--gray-lighter);
            position: relative;
        }

        .main-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--teacher-primary), var(--accent));
        }

        /* ==================== 页面头部 ==================== */
        .page-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--gray-light);
        }

        .page-title {
            font-size: 32px;
            font-weight: 800;
            color: var(--dark);
            margin-bottom: 8px;
            background: linear-gradient(90deg, var(--teacher-primary), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: inline-block;
        }

        .page-subtitle {
            color: var(--gray);
            font-size: 16px;
            line-height: 1.5;
        }

        /* ==================== 卡片设计 ==================== */
        .card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--gray-light);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--teacher-primary), var(--accent));
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            position: relative;
        }

        .card-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            color: var(--teacher-primary);
        }

        .card-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--teacher-primary), var(--teacher-dark));
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            box-shadow: 0 4px 12px rgba(79, 106, 245, 0.3);
        }

        .card-icon.accent {
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
        }

        /* ==================== 按钮样式 ==================== */
        .btn {
            background: var(--teacher-primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: var(--border-radius-sm);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 106, 245, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 13px;
        }

        .btn-lg {
            padding: 16px 32px;
            font-size: 16px;
        }

        .btn-success {
            background: var(--accent);
        }

        .btn-success:hover {
            background: var(--accent-dark);
            box-shadow: 0 8px 25px rgba(6, 214, 160, 0.4);
        }

        .btn-danger {
            background: var(--danger);
        }

        .btn-danger:hover {
            background: #ec325c;
            box-shadow: 0 8px 25px rgba(239, 71, 111, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: var(--teacher-primary);
            border: 2px solid var(--teacher-primary);
        }

        .btn-outline:hover {
            background: var(--teacher-primary);
            color: white;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            padding: 0;
            border-radius: 50%;
            justify-content: center;
        }

        /* ==================== 表格样式 ==================== */
        .table-container {
            overflow-x: auto;
            border-radius: var(--border-radius-sm);
            border: 1px solid var(--gray-light);
            background: white;
            position: relative;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        thead {
            background: linear-gradient(90deg, var(--teacher-primary), var(--teacher-dark));
        }

        th {
            padding: 16px;
            text-align: left;
            font-weight: 600;
            color: white;
            position: relative;
        }

        th:not(:last-child)::after {
            content: '';
            position: absolute;
            right: 0;
            top: 20%;
            bottom: 20%;
            width: 1px;
            background: rgba(255, 255, 255, 0.2);
        }

        th.sortable {
            cursor: pointer;
            user-select: none;
        }

        th.sortable:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .sort-indicator {
            margin-left: 5px;
            opacity: 0.7;
            transition: transform 0.3s ease;
        }

        th.sort-asc .sort-indicator {
            transform: rotate(180deg);
        }

        td {
            padding: 16px;
            border-bottom: 1px solid var(--gray-light);
            vertical-align: middle;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background: rgba(79, 106, 245, 0.04);
        }

        tr.selected {
            background: rgba(79, 106, 245, 0.1);
        }

        /* ==================== 表单样式 ==================== */
        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 600;
            font-size: 14px;
        }

        .form-hint {
            display: block;
            margin-top: 5px;
            color: var(--gray);
            font-size: 13px;
            line-height: 1.4;
        }

        .input-wrapper {
            position: relative;
        }

        .input-wrapper i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
            transition: var(--transition);
        }

        input, select, textarea {
            width: 100%;
            padding: 14px 15px 14px 45px;
            border: 2px solid var(--gray-light);
            border-radius: var(--border-radius-sm);
            font-size: 15px;
            transition: var(--transition);
            outline: none;
            background: white;
            color: var(--dark);
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--teacher-primary);
            box-shadow: 0 0 0 3px rgba(79, 106, 245, 0.1);
        }

        input:focus + i, select:focus + i {
            color: var(--teacher-primary);
        }

        textarea {
            min-height: 120px;
            font-family: inherit;
            resize: vertical;
        }

        .checkbox-group, .radio-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .checkbox-item, .radio-item {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 8px;
            border-radius: var(--border-radius-sm);
            transition: var(--transition);
        }

        .checkbox-item:hover, .radio-item:hover {
            background: var(--gray-lighter);
        }

        .checkbox-item input, .radio-item input {
            width: 18px;
            height: 18px;
        }

        /* ==================== 状态标签 ==================== */
        .status-badge {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }

        .status-active {
            background: rgba(6, 214, 160, 0.15);
            color: var(--accent);
            border: 1px solid rgba(6, 214, 160, 0.3);
        }

        .status-inactive {
            background: rgba(239, 71, 111, 0.15);
            color: var(--danger);
            border: 1px solid rgba(239, 71, 111, 0.3);
        }

        .status-warning {
            background: rgba(255, 209, 102, 0.15);
            color: #b38c00;
            border: 1px solid rgba(255, 209, 102, 0.3);
        }

        .status-info {
            background: rgba(79, 106, 245, 0.15);
            color: var(--teacher-primary);
            border: 1px solid rgba(79, 106, 245, 0.3);
        }

        /* ==================== 操作按钮组 ==================== */
        .action-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 6px 12px;
            border-radius: var(--border-radius-sm);
            border: none;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 5px;
            background: var(--gray-light);
            color: var(--dark);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .action-btn.view {
            background: rgba(79, 106, 245, 0.1);
            color: var(--teacher-primary);
        }

        .action-btn.view:hover {
            background: var(--teacher-primary);
            color: white;
        }

        .action-btn.edit {
            background: rgba(255, 209, 102, 0.1);
            color: #b38c00;
        }

        .action-btn.edit:hover {
            background: var(--secondary);
            color: var(--dark);
        }

        .action-btn.delete {
            background: rgba(239, 71, 111, 0.1);
            color: var(--danger);
        }

        .action-btn.delete:hover {
            background: var(--danger);
            color: white;
        }

        .action-btn.export {
            background: rgba(6, 214, 160, 0.1);
            color: var(--accent);
        }

        .action-btn.export:hover {
            background: var(--accent);
            color: white;
        }

        /* ==================== 模态框 ==================== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            padding: 40px;
            max-width: 800px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
            transition: var(--transition);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: var(--gray-lighter);
            color: var(--danger);
        }

        .modal-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--gray-light);
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 8px;
        }

        .modal-subtitle {
            color: var(--gray);
            font-size: 15px;
        }

        .modal-footer {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            justify-content: flex-end;
            gap: 15px;
        }

        /* ==================== 提示消息 ==================== */
        .alert {
            padding: 16px 20px;
            border-radius: var(--border-radius-sm);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideIn 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .alert::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            border-radius: 2px;
        }

        .alert-success {
            background: rgba(6, 214, 160, 0.1);
            border: 1px solid rgba(6, 214, 160, 0.2);
            color: var(--accent);
        }

        .alert-success::before {
            background: var(--accent);
        }

        .alert-error {
            background: rgba(239, 71, 111, 0.1);
            border: 1px solid rgba(239, 71, 111, 0.2);
            color: var(--danger);
        }

        .alert-error::before {
            background: var(--danger);
        }

        .alert-warning {
            background: rgba(255, 209, 102, 0.1);
            border: 1px solid rgba(255, 209, 102, 0.2);
            color: #b38c00;
        }

        .alert-warning::before {
            background: var(--secondary);
        }

        .alert-info {
            background: rgba(79, 106, 245, 0.1);
            border: 1px solid rgba(79, 106, 245, 0.2);
            color: var(--teacher-primary);
        }

        .alert-info::before {
            background: var(--teacher-primary);
        }

        .alert i {
            font-size: 20px;
        }

        .alert-close {
            margin-left: auto;
            background: none;
            border: none;
            color: inherit;
            opacity: 0.6;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: var(--transition);
        }

        .alert-close:hover {
            opacity: 1;
            background: rgba(0, 0, 0, 0.1);
        }

        /* ==================== 加载动画 ==================== */
        .loading {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid var(--gray-light);
            border-top-color: var(--teacher-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid var(--gray-light);
            border-top-color: var(--teacher-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* ==================== 标签页 ==================== */
        .tab-container {
            display: flex;
            gap: 2px;
            margin-bottom: 30px;
            background: var(--gray-lighter);
            padding: 4px;
            border-radius: var(--border-radius-sm);
            overflow-x: auto;
        }

        .tab {
            padding: 12px 24px;
            border: none;
            background: transparent;
            color: var(--gray);
            font-weight: 600;
            cursor: pointer;
            border-radius: calc(var(--border-radius-sm) - 4px);
            transition: var(--transition);
            white-space: nowrap;
            position: relative;
        }

        .tab:hover {
            color: var(--teacher-primary);
            background: rgba(79, 106, 245, 0.05);
        }

        .tab.active {
            background: white;
            color: var(--teacher-primary);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .tab-badge {
            margin-left: 8px;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 600;
            background: var(--teacher-primary);
            color: white;
        }

        /* ==================== 网格布局 ==================== */
        .grid {
            display: grid;
            gap: 25px;
        }

        .grid-2 {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .grid-3 {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        .grid-4 {
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        }

        /* ==================== 统计卡片 ==================== */
        .stat-card {
            text-align: center;
            padding: 30px 20px;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover .stat-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .stat-icon {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--teacher-primary), var(--accent));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 28px;
            margin: 0 auto 20px;
            transition: var(--transition);
            box-shadow: 0 8px 20px rgba(79, 106, 245, 0.3);
        }

        .stat-number {
            font-size: 42px;
            font-weight: 800;
            color: var(--dark);
            margin-bottom: 5px;
            line-height: 1;
        }

        .stat-label {
            color: var(--gray);
            font-size: 15px;
            font-weight: 500;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            margin-top: 15px;
            font-size: 14px;
            font-weight: 600;
        }

        .stat-trend.up {
            color: var(--accent);
        }

        .stat-trend.down {
            color: var(--danger);
        }

        /* ==================== 文件上传 ==================== */
        .file-upload {
            border: 2px dashed var(--gray-light);
            border-radius: var(--border-radius);
            padding: 60px 40px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            background: white;
            position: relative;
            overflow: hidden;
        }

        .file-upload:hover {
            border-color: var(--teacher-primary);
            background: rgba(79, 106, 245, 0.02);
        }

        .file-upload.dragover {
            border-color: var(--accent);
            background: rgba(6, 214, 160, 0.05);
            transform: scale(1.02);
        }

        .file-upload-icon {
            font-size: 60px;
            color: var(--teacher-primary);
            margin-bottom: 20px;
            opacity: 0.8;
        }

        .file-upload-text {
            color: var(--dark);
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .file-upload-hint {
            color: var(--gray);
            font-size: 14px;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .file-upload-preview {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--gray-light);
        }

        /* ==================== 单词列表 ==================== */
        .word-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius-sm);
            margin-bottom: 10px;
            transition: var(--transition);
            background: white;
        }

        .word-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
            border-color: var(--teacher-primary);
        }

        .word-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .word-english {
            font-size: 18px;
            font-weight: 700;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .word-note {
            font-size: 14px;
            color: var(--accent);
            font-style: italic;
            background: rgba(6, 214, 160, 0.1);
            padding: 2px 8px;
            border-radius: 4px;
            display: inline-block;
        }

        .word-chinese {
            font-size: 15px;
            color: var(--gray);
        }

        .word-meta {
            display: flex;
            gap: 15px;
            font-size: 13px;
            color: var(--gray);
            margin-top: 5px;
        }

        /* ==================== 搜索栏 ==================== */
        .search-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            background: white;
            padding: 8px;
            border-radius: var(--border-radius-sm);
            box-shadow: var(--shadow);
        }

        .search-bar input {
            flex: 1;
            padding: 12px 20px 12px 45px;
            border: none;
            box-shadow: none;
        }

        .search-bar input:focus {
            box-shadow: none;
        }

        .search-bar .btn {
            padding: 12px 24px;
            white-space: nowrap;
        }

        /* ==================== 分页 ==================== */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--gray-light);
        }

        .page-btn {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius-sm);
            background: white;
            color: var(--dark);
            cursor: pointer;
            transition: var(--transition);
            font-size: 14px;
            font-weight: 500;
        }

        .page-btn:hover {
            border-color: var(--teacher-primary);
            color: var(--teacher-primary);
        }

        .page-btn.active {
            background: var(--teacher-primary);
            color: white;
            border-color: var(--teacher-primary);
        }

        .page-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .page-btn.disabled:hover {
            border-color: var(--gray-light);
            color: var(--dark);
        }

        /* ==================== 进度条 ==================== */
        .progress-bar {
            height: 8px;
            background: var(--gray-light);
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--teacher-primary), var(--accent));
            border-radius: 4px;
            transition: width 1s ease-in-out;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            width: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 13px;
            color: var(--gray);
        }

        /* ==================== 空状态 ==================== */
        .empty-state {
            text-align: center;
            padding: 60px 40px;
        }

        .empty-state-icon {
            font-size: 80px;
            color: var(--gray-light);
            margin-bottom: 20px;
        }

        .empty-state-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--gray);
            margin-bottom: 10px;
        }

        .empty-state-text {
            color: var(--gray);
            font-size: 15px;
            line-height: 1.5;
            max-width: 400px;
            margin: 0 auto 30px;
        }

        /* ==================== 工具提示 ==================== */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip-text {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--dark);
            color: white;
            padding: 8px 12px;
            border-radius: var(--border-radius-sm);
            font-size: 12px;
            font-weight: 500;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
            z-index: 100;
            margin-bottom: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .tooltip-text::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: var(--dark);
        }

        .tooltip:hover .tooltip-text {
            opacity: 1;
            visibility: visible;
        }

        /* ==================== 学生详情页面 ==================== */
        .student-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--gray-light);
        }

        .student-avatar {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--teacher-primary), var(--accent));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 40px;
            box-shadow: 0 8px 25px rgba(79, 106, 245, 0.3);
        }

        .student-info {
            flex: 1;
        }

        .student-name {
            font-size: 28px;
            font-weight: 800;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .student-id {
            color: var(--gray);
            font-size: 15px;
            margin-bottom: 15px;
        }

        .student-stats {
            display: flex;
            gap: 20px;
        }

        .student-stat-item {
            text-align: center;
        }

        .student-stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--teacher-primary);
            margin-bottom: 4px;
        }

        .student-stat-label {
            font-size: 13px;
            color: var(--gray);
            font-weight: 500;
        }

        /* ==================== 响应式设计 ==================== */
        @media (max-width: 1200px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                padding: 20px;
            }
            
            .nav-menu {
                flex-direction: row;
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .nav-item {
                flex: 1;
                min-width: 150px;
                justify-content: center;
            }
            
            .main-content {
                padding: 20px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                min-height: calc(100vh - 20px);
            }
            
            .page-title {
                font-size: 24px;
            }
            
            .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .modal-content {
                padding: 20px;
                width: 95%;
            }
            
            .student-header {
                flex-direction: column;
                text-align: center;
            }
            
            .student-stats {
                justify-content: center;
            }
        }

        /* ==================== 动画效果 ==================== */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in-up {
            animation: fadeInUp 0.6s ease forwards;
        }

        .delay-1 { animation-delay: 0.1s; }
        .delay-2 { animation-delay: 0.2s; }
        .delay-3 { animation-delay: 0.3s; }
        .delay-4 { animation-delay: 0.4s; }
        .delay-5 { animation-delay: 0.5s; }

        /* ==================== 滚动条样式 ==================== */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-lighter);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gray-light);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--gray);
        }

        /* ==================== 打印样式 ==================== */
        @media print {
            .sidebar, .btn, .action-btn, .modal-close {
                display: none !important;
            }
            
            .container {
                flex-direction: column;
                box-shadow: none;
            }
            
            .main-content {
                padding: 0;
            }
            
            .card {
                box-shadow: none;
                border: 1px solid #ddd;
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <!-- 主容器 -->
    <div class="container">
        <!-- 侧边栏 -->
        <div class="sidebar">
            <div class="user-info">
                <div class="avatar">
                    <i class="fas fa-chalkboard-teacher"></i>
                </div>
                <div class="user-name" id="userName">Kathy老师</div>
                <div class="user-role">教师</div>
            </div>
            
            <nav class="nav-menu">
                <div class="nav-item active" data-page="dashboard">
                    <i class="fas fa-home"></i>
                    <span>控制台</span>
                </div>
                <div class="nav-item" data-page="students">
                    <i class="fas fa-user-graduate"></i>
                    <span>学生管理</span>
                    <span class="nav-badge" id="studentCount">45</span>
                </div>
                <div class="nav-item" data-page="words">
                    <i class="fas fa-book"></i>
                    <span>单词管理</span>
                    <span class="nav-badge" id="wordCount">523</span>
                </div>
                <div class="nav-item" data-page="parents">
                    <i class="fas fa-user-friends"></i>
                    <span>家长管理</span>
                </div>
                <div class="nav-item" data-page="analytics">
                    <i class="fas fa-chart-bar"></i>
                    <span>数据统计</span>
                </div>
                <div class="nav-item" data-page="upload">
                    <i class="fas fa-upload"></i>
                    <span>单词上传</span>
                </div>
            </nav>
            
            <button class="btn logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                <span>退出登录</span>
            </button>
        </div>

        <!-- 主内容区 -->
        <div class="main-content" id="mainContent">
            <!-- 内容将通过JavaScript动态加载 -->
        </div>
    </div>

    <!-- 模态框 -->
    <div class="modal" id="modal">
        <div class="modal-content" id="modalContent">
            <!-- 模态框内容将通过JavaScript动态加载 -->
        </div>
    </div>

    <!-- 加载遮罩 -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <script src="https://unpkg.com/@supabase/supabase-js@2.38.4"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script>
        // ==================== 系统配置 ====================
        const SUPABASE_CONFIG = {
            url: 'https://lmuevzsrbmwgmiajbmnl.supabase.co',
            key: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxtdWV2enNyYm13Z21pYWpibW5sIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk0MTU1NTgsImV4cCI6MjA4NDk5MTU1OH0.z37w3IqppAaNlJ5yHao5M7Lg090rPJ8KoZLsJXcA8zw'
        };

        // ==================== 核心应用类 ====================
        class TeacherApp {
            constructor() {
                this.currentPage = 'dashboard';
                this.supabase = window.supabase.createClient(SUPABASE_CONFIG.url, SUPABASE_CONFIG.key);
                this.user = {
                    name: 'Kathy老师',
                    role: 'teacher'
                };
                this.students = [];
                this.words = [];
                this.parents = [];
                this.wordSortOrder = 'time'; // time, a-z, difficulty
                this.init();
            }

            // 初始化应用
            async init() {
                this.setupEventListeners();
                this.loadUserInfo();
                await this.loadInitialData();
                this.loadPage('dashboard');
                
                // 检查登录状态
                const savedRole = localStorage.getItem('userRole');
                if (!savedRole || savedRole !== 'teacher') {
                    window.location.href = 'index.html';
                }
            }

            // 设置事件监听器
            setupEventListeners() {
                // 导航点击
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        const page = item.dataset.page;
                        this.loadPage(page);
                        
                        // 更新活动状态
                        document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                        item.classList.add('active');
                    });
                });
                
                // 退出登录
                document.getElementById('logoutBtn').addEventListener('click', () => {
                    if (confirm('确定要退出登录吗？')) {
                        localStorage.clear();
                        window.location.href = 'index.html';
                    }
                });
                
                // 模态框关闭
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('modal') || 
                        e.target.classList.contains('modal-close') ||
                        e.target.closest('.modal-close')) {
                        this.closeModal();
                    }
                });
                
                // ESC键关闭模态框
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.closeModal();
                    }
                });
            }

            // 加载用户信息
            loadUserInfo() {
                const savedName = localStorage.getItem('userName');
                if (savedName) {
                    this.user.name = savedName;
                }
                document.getElementById('userName').textContent = this.user.name;
            }

            // 加载初始数据
            async loadInitialData() {
                this.showLoading();
                
                try {
                    // 模拟加载数据
                    await this.loadStudents();
                    await this.loadWords();
                    await this.loadParents();
                    
                    // 更新计数
                    document.getElementById('studentCount').textContent = this.students.length;
                    document.getElementById('wordCount').textContent = this.words.length;
                    
                } catch (error) {
                    this.showAlert('数据加载失败: ' + error.message, 'error');
                } finally {
                    this.hideLoading();
                }
            }

            // 加载学生数据
            async loadStudents() {
                // 模拟数据
                this.students = [
                    {
                        id: 'S0231',
                        name: '小明',
                        grade: '三年级',
                        lastLogin: '2024-01-20 08:30',
                        streakDays: 20,
                        todayDone: true,
                        mastered: 450,
                        fuzzy: 120,
                        forgotten: 80,
                        joinDate: '2024-01-01',
                        totalHours: 45,
                        avgAccuracy: 88,
                        recentActivity: [
                            { date: '2024-01-20', words: 25, time: '12min', accuracy: 92 },
                            { date: '2024-01-19', words: 22, time: '10min', accuracy: 88 }
                        ]
                    },
                    {
                        id: 'S0412',
                        name: '小红',
                        grade: '二年级',
                        lastLogin: '2024-01-20 06:30',
                        streakDays: 15,
                        todayDone: true,
                        mastered: 380,
                        fuzzy: 95,
                        forgotten: 45,
                        joinDate: '2024-01-05',
                        totalHours: 32,
                        avgAccuracy: 85,
                        recentActivity: [
                            { date: '2024-01-20', words: 20, time: '9min', accuracy: 90 }
                        ]
                    },
                    {
                        id: 'S0188',
                        name: '小刚',
                        grade: '三年级',
                        lastLogin: '2024-01-19 20:15',
                        streakDays: 8,
                        todayDone: false,
                        mastered: 280,
                        fuzzy: 150,
                        forgotten: 120,
                        joinDate: '2024-01-10',
                        totalHours: 25,
                        avgAccuracy: 75,
                        recentActivity: [
                            { date: '2024-01-19', words: 18, time: '15min', accuracy: 78 }
                        ]
                    }
                ];
            }

            // 加载单词数据
            async loadWords() {
                // 模拟数据
                this.words = [
                    {
                        id: 1,
                        english: 'apple',
                        chinese: '苹果',
                        note: '复数: apples',
                        difficulty: 1,
                        created: '2024-01-01',
                        group: '核心词汇800',
                        masteredCount: 45,
                        example: 'I eat an apple every day.'
                    },
                    {
                        id: 2,
                        english: 'banana',
                        chinese: '香蕉',
                        note: '',
                        difficulty: 1,
                        created: '2024-01-01',
                        group: '核心词汇800',
                        masteredCount: 45,
                        example: 'Bananas are rich in potassium.'
                    },
                    {
                        id: 3,
                        english: 'computer',
                        chinese: '电脑',
                        note: '',
                        difficulty: 2,
                        created: '2024-01-05',
                        group: '日常用语200',
                        masteredCount: 38,
                        example: 'I use a computer for work.'
                    },
                    {
                        id: 4,
                        english: 'good morning',
                        chinese: '早上好',
                        note: '短语',
                        difficulty: 2,
                        created: '2024-01-05',
                        group: '日常用语200',
                        masteredCount: 38,
                        example: 'Good morning, teacher!'
                    }
                ];
            }

            // 加载家长数据
            async loadParents() {
                // 模拟数据
                this.parents = [
                    {
                        id: 'parent_zhang',
                        name: '张爸爸',
                        phone: '138****1234',
                        students: ['小明', '小亮'],
                        created: '2024-01-01',
                        lastLogin: '2024-01-20 19:30'
                    },
                    {
                        id: 'parent_li',
                        name: '李妈妈',
                        phone: '139****5678',
                        students: ['小红'],
                        created: '2024-01-05',
                        lastLogin: '2024-01-19 15:20'
                    }
                ];
            }

            // 加载页面
            async loadPage(page) {
                this.currentPage = page;
                const container = document.getElementById('mainContent');
                container.innerHTML = '';
                
                switch(page) {
                    case 'dashboard':
                        container.innerHTML = this.renderDashboard();
                        break;
                    case 'students':
                        container.innerHTML = this.renderStudents();
                        this.setupStudentsEvents();
                        break;
                    case 'words':
                        container.innerHTML = this.renderWords();
                        this.setupWordsEvents();
                        break;
                    case 'parents':
                        container.innerHTML = this.renderParents();
                        this.setupParentsEvents();
                        break;
                    case 'analytics':
                        container.innerHTML = this.renderAnalytics();
                        this.setupAnalyticsEvents();
                        break;
                    case 'upload':
                        container.innerHTML = this.renderUpload();
                        this.setupUploadEvents();
                        break;
                    default:
                        container.innerHTML = this.renderDashboard();
                }
                
                // 添加动画效果
                setTimeout(() => {
                    const cards = container.querySelectorAll('.card, .stat-card');
                    cards.forEach((card, index) => {
                        card.classList.add('animate-fade-in-up');
                        card.classList.add(`delay-${(index % 5) + 1}`);
                    });
                }, 100);
            }

            // ==================== 页面渲染方法 ====================

            // 渲染控制台
            renderDashboard() {
                const today = new Date().toLocaleDateString('zh-CN', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    weekday: 'long'
                });
                
                const completedStudents = this.students.filter(s => s.todayDone).length;
                const completionRate = Math.round((completedStudents / this.students.length) * 100);
                const avgStreak = Math.round(this.students.reduce((sum, s) => sum + s.streakDays, 0) / this.students.length);
                const avgAccuracy = Math.round(this.students.reduce((sum, s) => sum + s.avgAccuracy, 0) / this.students.length);
                
                return `
                    <div class="page-header">
                        <h1 class="page-title">教师控制台</h1>
                        <p class="page-subtitle">${today} | 欢迎回来，${this.user.name}！</p>
                    </div>
                    
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        <span>今日已有${completedStudents}位学生完成打卡，完成率${completionRate}%</span>
                    </div>
                    
                    <div class="grid grid-4">
                        <div class="stat-card card">
                            <div class="stat-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-number">${this.students.length}</div>
                            <div class="stat-label">总学生数</div>
                        </div>
                        
                        <div class="stat-card card">
                            <div class="stat-icon">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="stat-number">${completionRate}%</div>
                            <div class="stat-label">今日打卡率</div>
                            <div class="stat-trend up">
                                <i class="fas fa-arrow-up"></i>
                                <span>较昨日 ↑5%</span>
                            </div>
                        </div>
                        
                        <div class="stat-card card">
                            <div class="stat-icon">
                                <i class="fas fa-fire"></i>
                            </div>
                            <div class="stat-number">${avgStreak}</div>
                            <div class="stat-label">平均连续天数</div>
                            <div class="stat-trend up">
                                <i class="fas fa-arrow-up"></i>
                                <span>较上周 ↑2天</span>
                            </div>
                        </div>
                        
                        <div class="stat-card card">
                            <div class="stat-icon">
                                <i class="fas fa-bullseye"></i>
                            </div>
                            <div class="stat-number">${avgAccuracy}%</div>
                            <div class="stat-label">平均正确率</div>
                        </div>
                    </div>
                    
                    <div class="grid grid-2">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i class="fas fa-trophy"></i>
                                    今日之星
                                </h3>
                            </div>
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>排名</th>
                                            <th>学生</th>
                                            <th>成就</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><i class="fas fa-trophy" style="color: #FFD166;"></i> 1</td>
                                            <td>S0231 小明</td>
                                            <td>连续20天学习</td>
                                            <td>
                                                <button class="action-btn view" onclick="app.praiseStudent('S0231')">
                                                    <i class="fas fa-thumbs-up"></i>
                                                    表扬
                                                </button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><i class="fas fa-medal" style="color: silver;"></i> 2</td>
                                            <td>S0412 小红</td>
                                            <td>今日最早完成 (06:30)</td>
                                            <td>
                                                <button class="action-btn view" onclick="app.praiseStudent('S0412')">
                                                    <i class="fas fa-thumbs-up"></i>
                                                    表扬
                                                </button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><i class="fas fa-award" style="color: #CD7F32;"></i> 3</td>
                                            <td>S0188 小刚</td>
                                            <td>今日掌握18个新词</td>
                                            <td>
                                                <button class="action-btn view" onclick="app.praiseStudent('S0188')">
                                                    <i class="fas fa-thumbs-up"></i>
                                                    表扬
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i class="fas fa-chart-line"></i>
                                    快速操作
                                </h3>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 10px;">
                                <button class="btn btn-outline" onclick="app.loadPage('upload')">
                                    <i class="fas fa-upload"></i>
                                    上传单词
                                </button>
                                <button class="btn btn-outline" onclick="app.loadPage('students')">
                                    <i class="fas fa-user-plus"></i>
                                    添加学生
                                </button>
                                <button class="btn btn-outline" onclick="app.loadPage('parents')">
                                    <i class="fas fa-user-friends"></i>
                                    创建家长账号
                                </button>
                                <button class="btn btn-outline" onclick="app.generateReport()">
                                    <i class="fas fa-file-export"></i>
                                    导出数据
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-bell"></i>
                                系统提醒
                            </h3>
                        </div>
                        <div style="padding: 15px;">
                            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid var(--gray-light);">
                                <div style="width: 10px; height: 10px; background: var(--accent); border-radius: 50%;"></div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600;">今日未打卡学生</div>
                                    <div style="color: var(--gray); font-size: 14px;">${this.students.filter(s => !s.todayDone).length}位学生尚未完成今日学习</div>
                                </div>
                                <button class="btn btn-sm" onclick="app.loadPage('students')">
                                    查看
                                </button>
                            </div>
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div style="width: 10px; height: 10px; background: var(--teacher-primary); border-radius: 50%;"></div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600;">单词库更新</div>
                                    <div style="color: var(--gray); font-size: 14px;">已有${this.words.length}个单词，建议定期更新</div>
                                </div>
                                <button class="btn btn-sm" onclick="app.loadPage('upload')">
                                    上传
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }

            // 渲染学生管理页面
            renderStudents() {
                return `
                    <div class="page-header">
                        <h1 class="page-title">学生管理</h1>
                        <p class="page-subtitle">共${this.students.length}位学生 | 今日完成: ${this.students.filter(s => s.todayDone).length}人</p>
                    </div>
                    
                    <div class="search-bar">
                        <div class="input-wrapper" style="flex: 1;">
                            <i class="fas fa-search"></i>
                            <input type="text" id="studentSearch" placeholder="搜索学生姓名或ID...">
                        </div>
                        <select id="studentFilter" style="width: 150px; padding-left: 15px;">
                            <option value="all">全部状态</option>
                            <option value="completed">今日已完成</option>
                            <option value="pending">今日未完成</option>
                        </select>
                        <button class="btn btn-success" onclick="app.showAddStudentModal()">
                            <i class="fas fa-user-plus"></i>
                            添加学生
                        </button>
                    </div>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th class="sortable" onclick="app.sortStudents('name')">
                                        学生姓名
                                        <i class="fas fa-sort sort-indicator"></i>
                                    </th>
                                    <th>最后登录</th>
                                    <th>今日打卡</th>
                                    <th class="sortable" onclick="app.sortStudents('streak')">
                                        连续天数
                                        <i class="fas fa-sort sort-indicator"></i>
                                    </th>
                                    <th>掌握情况</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${this.students.map(student => `
                                    <tr>
                                        <td>
                                            <div style="font-weight: 600;">${student.name}</div>
                                            <div style="color: var(--gray); font-size: 13px;">ID: ${student.id} | ${student.grade}</div>
                                        </td>
                                        <td>${student.lastLogin}</td>
                                        <td>
                                            ${student.todayDone ? 
                                                '<span class="status-badge status-active"><i class="fas fa-check-circle"></i> 已完成</span>' : 
                                                '<span class="status-badge status-inactive"><i class="fas fa-times-circle"></i> 未完成</span>'
                                            }
                                        </td>
                                        <td>
                                            <div style="font-weight: 600; color: var(--danger);">${student.streakDays}天</div>
                                        </td>
                                        <td>
                                            <div style="display: flex; gap: 15px;">
                                                <div class="tooltip" style="cursor: pointer;" onclick="app.showStudentWords('${student.id}', 'mastered')">
                                                    <div style="font-weight: 600; color: var(--accent);">${student.mastered}</div>
                                                    <div style="font-size: 12px; color: var(--gray);">已掌握</div>
                                                    <div class="tooltip-text">点击查看详情</div>
                                                </div>
                                                <div class="tooltip" style="cursor: pointer;" onclick="app.showStudentWords('${student.id}', 'fuzzy')">
                                                    <div style="font-weight: 600; color: var(--secondary);">${student.fuzzy}</div>
                                                    <div style="font-size: 12px; color: var(--gray);">模糊</div>
                                                    <div class="tooltip-text">点击查看详情</div>
                                                </div>
                                                <div class="tooltip" style="cursor: pointer;" onclick="app.showStudentWords('${student.id}', 'forgotten')">
                                                    <div style="font-weight: 600; color: var(--danger);">${student.forgotten}</div>
                                                    <div style="font-size: 12px; color: var(--gray);">没印象</div>
                                                    <div class="tooltip-text">点击查看详情</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="action-buttons">
                                                <button class="action-btn view" onclick="app.showStudentDetail('${student.id}')">
                                                    <i class="fas fa-eye"></i>
                                                    详情
                                                </button>
                                                <button class="action-btn edit" onclick="app.editStudent('${student.id}')">
                                                    <i class="fas fa-edit"></i>
                                                    编辑
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                    
                    ${this.students.length === 0 ? `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-user-graduate"></i>
                            </div>
                            <div class="empty-state-title">暂无学生数据</div>
                            <div class="empty-state-text">点击"添加学生"按钮，开始添加您的第一位学生</div>
                            <button class="btn btn-success" onclick="app.showAddStudentModal()">
                                <i class="fas fa-user-plus"></i>
                                添加学生
                            </button>
                        </div>
                    ` : ''}
                `;
            }

            // 渲染单词管理页面
            renderWords() {
                const sortedWords = this.sortWords(this.words, this.wordSortOrder);
                
                return `
                    <div class="page-header">
                        <h1 class="page-title">单词管理</h1>
                        <p class="page-subtitle">共${this.words.length}个单词 | 分组: 核心词汇800、日常用语200</p>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <div class="btn-group">
                            <button class="btn ${this.wordSortOrder === 'time' ? 'active' : 'btn-outline'}" onclick="app.changeWordSort('time')">
                                <i class="fas fa-clock"></i>
                                按上传时间
                            </button>
                            <button class="btn ${this.wordSortOrder === 'a-z' ? 'active' : 'btn-outline'}" onclick="app.changeWordSort('a-z')">
                                <i class="fas fa-sort-alpha-down"></i>
                                按A-Z排序
                            </button>
                            <button class="btn ${this.wordSortOrder === 'difficulty' ? 'active' : 'btn-outline'}" onclick="app.changeWordSort('difficulty')">
                                <i class="fas fa-chart-line"></i>
                                按难易度
                            </button>
                        </div>
                        
                        <div class="btn-group">
                            <button class="btn btn-outline" onclick="app.exportWords()">
                                <i class="fas fa-download"></i>
                                导出单词
                            </button>
                            <button class="btn btn-success" onclick="app.loadPage('upload')">
                                <i class="fas fa-upload"></i>
                                上传单词
                            </button>
                        </div>
                    </div>
                    
                    <div class="search-bar">
                        <div class="input-wrapper" style="flex: 1;">
                            <i class="fas fa-search"></i>
                            <input type="text" id="wordSearch" placeholder="搜索英文或中文...">
                        </div>
                        <select id="wordGroupFilter" style="width: 150px; padding-left: 15px;">
                            <option value="all">全部分组</option>
                            <option value="核心词汇800">核心词汇800</option>
                            <option value="日常用语200">日常用语200</option>
                        </select>
                        <button class="btn" onclick="app.filterWords()">
                            <i class="fas fa-filter"></i>
                            筛选
                        </button>
                    </div>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th class="sortable" onclick="app.changeWordSort('a-z')">
                                        英文单词
                                        <i class="fas fa-sort sort-indicator"></i>
                                    </th>
                                    <th>中文释义</th>
                                    <th>备注</th>
                                    <th class="sortable" onclick="app.changeWordSort('difficulty')">
                                        难易度
                                        <i class="fas fa-sort sort-indicator"></i>
                                    </th>
                                    <th>分组</th>
                                    <th>掌握人数</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${sortedWords.map(word => `
                                    <tr>
                                        <td>
                                            <div class="word-english">
                                                ${word.english}
                                                ${word.note ? `<span class="word-note">${word.note}</span>` : ''}
                                            </div>
                                            ${word.example ? `<div style="color: var(--gray); font-size: 13px; font-style: italic; margin-top: 5px;">${word.example}</div>` : ''}
                                        </td>
                                        <td>${word.chinese}</td>
                                        <td>
                                            ${word.note ? `
                                                <div style="background: rgba(6, 214, 160, 0.1); padding: 4px 8px; border-radius: 4px; font-size: 13px;">
                                                    ${word.note}
                                                </div>
                                            ` : '<span style="color: var(--gray);">-</span>'}
                                        </td>
                                        <td>
                                            <div style="display: flex; align-items: center; gap: 5px;">
                                                ${this.renderDifficultyStars(word.difficulty)}
                                                <span style="color: var(--gray); font-size: 13px;">(${this.getDifficultyText(word.difficulty)})</span>
                                            </div>
                                        </td>
                                        <td>
                                            <span class="status-badge status-info">${word.group}</span>
                                        </td>
                                        <td>
                                            <div style="font-weight: 600; color: var(--teacher-primary);">${word.masteredCount}</div>
                                            <div style="font-size: 12px; color: var(--gray);">${Math.round((word.masteredCount / 45) * 100)}%</div>
                                        </td>
                                        <td>
                                            <div class="action-buttons">
                                                <button class="action-btn edit" onclick="app.editWord(${word.id})">
                                                    <i class="fas fa-edit"></i>
                                                    编辑
                                                </button>
                                                <button class="action-btn delete" onclick="app.deleteWord(${word.id})">
                                                    <i class="fas fa-trash"></i>
                                                    删除
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                    
                    ${this.words.length === 0 ? `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-book"></i>
                            </div>
                            <div class="empty-state-title">暂无单词数据</div>
                            <div class="empty-state-text">点击"上传单词"按钮，开始创建您的单词库</div>
                            <button class="btn btn-success" onclick="app.loadPage('upload')">
                                <i class="fas fa-upload"></i>
                                上传单词
                            </button>
                        </div>
                    ` : ''}
                `;
            }

            // 渲染家长管理页面
            renderParents() {
                return `
                    <div class="page-header">
                        <h1 class="page-title">家长管理</h1>
                        <p class="page-subtitle">共${this.parents.length}个家长账号</p>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <div>
                            <button class="btn btn-success" onclick="app.showCreateParentModal()">
                                <i class="fas fa-user-plus"></i>
                                创建家长账号
                            </button>
                            <button class="btn btn-outline" onclick="app.showParentGuide()" style="margin-left: 10px;">
                                <i class="fas fa-question-circle"></i>
                                使用指南
                            </button>
                        </div>
                    </div>
                    
                    <div class="search-bar">
                        <div class="input-wrapper" style="flex: 1;">
                            <i class="fas fa-search"></i>
                            <input type="text" id="parentSearch" placeholder="搜索家长姓名或账号...">
                        </div>
                        <button class="btn" onclick="app.filterParents()">
                            <i class="fas fa-filter"></i>
                            搜索
                        </button>
                    </div>
                    
                    <div class="grid grid-3">
                        ${this.parents.map(parent => `
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-icon accent">
                                        <i class="fas fa-user-friends"></i>
                                    </div>
                                </div>
                                <h3 style="margin-bottom: 15px;">${parent.name}</h3>
                                <div style="margin-bottom: 15px;">
                                    <div style="color: var(--gray); font-size: 13px;">账号</div>
                                    <div style="font-weight: 600; color: var(--dark);">${parent.id}</div>
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <div style="color: var(--gray); font-size: 13px;">关联学生</div>
                                    <div style="font-weight: 500; color: var(--teacher-primary);">${parent.students.join('、')}</div>
                                </div>
                                <div style="margin-bottom: 20px;">
                                    <div style="color: var(--gray); font-size: 13px;">最后登录</div>
                                    <div style="font-size: 14px; color: var(--dark);">${parent.lastLogin}</div>
                                </div>
                                <div class="action-buttons">
                                    <button class="action-btn view" onclick="app.viewParent('${parent.id}')">
                                        <i class="fas fa-eye"></i>
                                        查看
                                    </button>
                                    <button class="action-btn edit" onclick="app.editParent('${parent.id}')">
                                        <i class="fas fa-edit"></i>
                                        编辑
                                    </button>
                                    <button class="action-btn delete" onclick="app.deleteParent('${parent.id}')">
                                        <i class="fas fa-trash"></i>
                                        删除
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    ${this.parents.length === 0 ? `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-user-friends"></i>
                            </div>
                            <div class="empty-state-title">暂无家长账号</div>
                            <div class="empty-state-text">创建家长账号，让家长可以查看孩子的学习进度</div>
                            <button class="btn btn-success" onclick="app.showCreateParentModal()">
                                <i class="fas fa-user-plus"></i>
                                创建家长账号
                            </button>
                        </div>
                    ` : ''}
                `;
            }

            // 渲染数据统计页面
            renderAnalytics() {
                const today = new Date().toLocaleDateString('zh-CN', { month: 'long', day: 'numeric' });
                const completedStudents = this.students.filter(s => s.todayDone).length;
                const completionRate = Math.round((completedStudents / this.students.length) * 100);
                
                return `
                    <div class="page-header">
                        <h1 class="page-title">数据统计</h1>
                        <p class="page-subtitle">${today} | 系统数据分析报告</p>
                    </div>
                    
                    <div class="tab-container">
                        <button class="tab active" data-tab="overview">总览</button>
                        <button class="tab" data-tab="activity">活跃度</button>
                        <button class="tab" data-tab="progress">进步分析</button>
                        <button class="tab" data-tab="export">数据导出</button>
                    </div>
                    
                    <div id="analyticsContent">
                        <div class="grid grid-2">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fas fa-chart-pie"></i>
                                        学习状态分布
                                    </h3>
                                </div>
                                <div style="padding: 20px;">
                                    <div style="display: flex; justify-content: space-around; margin-bottom: 30px;">
                                        <div style="text-align: center;">
                                            <div style="font-size: 36px; font-weight: 800; color: var(--accent);">${completedStudents}</div>
                                            <div style="color: var(--gray);">今日完成</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-size: 36px; font-weight: 800; color: var(--danger);">${this.students.length - completedStudents}</div>
                                            <div style="color: var(--gray);">今日未完成</div>
                                        </div>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: ${completionRate}%"></div>
                                    </div>
                                    <div class="progress-text">
                                        <span>打卡率</span>
                                        <span>${completionRate}%</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fas fa-fire"></i>
                                        连续学习排行榜
                                    </h3>
                                </div>
                                <div style="padding: 20px;">
                                    ${this.getTopStudentsByStreak(5).map((student, index) => `
                                        <div style="display: flex; align-items: center; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid var(--gray-light);">
                                            <div style="display: flex; align-items: center; gap: 10px;">
                                                <div style="width: 30px; height: 30px; background: ${index === 0 ? '#FFD166' : index === 1 ? 'silver' : index === 2 ? '#CD7F32' : 'var(--gray-light)'}; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600;">
                                                    ${index + 1}
                                                </div>
                                                <div>
                                                    <div style="font-weight: 600;">${student.name}</div>
                                                    <div style="font-size: 13px; color: var(--gray);">${student.grade}</div>
                                                </div>
                                            </div>
                                            <div style="font-weight: 700; color: var(--danger);">${student.streakDays}天</div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i class="fas fa-chart-line"></i>
                                    活跃度分析
                                </h3>
                                <button class="btn btn-outline" onclick="app.generateActivityReport()">
                                    <i class="fas fa-download"></i>
                                    导出报告
                                </button>
                            </div>
                            <div style="padding: 20px;">
                                <div style="display: flex; gap: 30px; margin-bottom: 30px;">
                                    <div>
                                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">平均每日学习时间</div>
                                        <div style="font-size: 24px; font-weight: 700; color: var(--dark);">12.5分钟</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">平均每日单词数</div>
                                        <div style="font-size: 24px; font-weight: 700; color: var(--dark);">22.3个</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 14px; color: var(--gray); margin-bottom: 5px;">平均正确率</div>
                                        <div style="font-size: 24px; font-weight: 700; color: var(--dark);">85.6%</div>
                                    </div>
                                </div>
                                
                                <div style="background: var(--gray-lighter); padding: 20px; border-radius: var(--border-radius-sm);">
                                    <div style="font-weight: 600; margin-bottom: 15px;">每日活跃时间分布</div>
                                    <div style="display: flex; align-items: flex-end; gap: 10px; height: 200px;">
                                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                            <div style="background: var(--teacher-primary); width: 80%; border-radius: 4px 4px 0 0; margin-bottom: 10px;" 
                                                 style="height: 150px;"></div>
                                            <div style="font-size: 12px; color: var(--gray);">07:00-09:00</div>
                                        </div>
                                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                            <div style="background: var(--accent); width: 80%; border-radius: 4px 4px 0 0; margin-bottom: 10px;" 
                                                 style="height: 80px;"></div>
                                            <div style="font-size: 12px; color: var(--gray);">12:00-14:00</div>
                                        </div>
                                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                            <div style="background: var(--teacher-primary); width: 80%; border-radius: 4px 4px 0 0; margin-bottom: 10px;" 
                                                 style="height: 180px;"></div>
                                            <div style="font-size: 12px; color: var(--gray);">18:00-20:00</div>
                                        </div>
                                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                            <div style="background: var(--secondary); width: 80%; border-radius: 4px 4px 0 0; margin-bottom: 10px;" 
                                                 style="height: 60px;"></div>
                                            <div style="font-size: 12px; color: var(--gray);">20:00-22:00</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // 渲染单词上传页面
            renderUpload() {
                return `
                    <div class="page-header">
                        <h1 class="page-title">单词上传</h1>
                        <p class="page-subtitle">批量上传单词，支持多种格式</p>
                    </div>
                    
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        <span>支持格式：英文 | 中文 | 备注（可选）| 例句（可选）</span>
                    </div>
                    
                    <div class="grid grid-2">
                        <div class="card">
                            <h3 style="margin-bottom: 20px;">
                                <i class="fas fa-cloud-upload-alt"></i>
                                上传文件
                            </h3>
                            <div class="file-upload" id="fileUpload">
                                <div class="file-upload-icon">
                                    <i class="fas fa-file-upload"></i>
                                </div>
                                <div class="file-upload-text">拖放文件到此处或点击上传</div>
                                <div class="file-upload-hint">
                                    支持.txt, .csv, .xlsx格式<br>
                                    每行格式：英文 | 中文 | 备注 | 例句
                                </div>
                                <button class="btn" onclick="document.getElementById('fileInput').click()">
                                    <i class="fas fa-folder-open"></i>
                                    选择文件
                                </button>
                                <input type="file" id="fileInput" accept=".txt,.csv,.xlsx" style="display: none;">
                            </div>
                        </div>
                        
                        <div class="card">
                            <h3 style="margin-bottom: 20px;">
                                <i class="fas fa-clipboard-list"></i>
                                手动输入
                            </h3>
                            <div class="form-group">
                                <label>单词列表</label>
                                <textarea id="manualInput" placeholder="每行一个单词，格式：英文 | 中文 | 备注（可选）| 例句（可选）
示例：
apple | 苹果 | 复数: apples | I eat an apple every day.
good morning | 早上好 | 短语 | Good morning, teacher!
run | 跑 | 动词，过去式: ran | He runs very fast." rows="10"></textarea>
                                <div class="form-hint">
                                    备注格式：(括号)表示单词功能注释，如(第三人称单数)、(复数)、(不规则动词)
                                </div>
                            </div>
                            <div class="form-group">
                                <label>选择分组</label>
                                <select id="wordGroup">
                                    <option value="核心词汇800">核心词汇800</option>
                                    <option value="日常用语200">日常用语200</option>
                                    <option value="考试必备500">考试必备500</option>
                                    <option value="自定义分组">自定义分组</option>
                                </select>
                                <div id="customGroupContainer" style="display: none; margin-top: 10px;">
                                    <input type="text" id="customGroupName" placeholder="输入新分组名称" style="padding-left: 15px;">
                                </div>
                            </div>
                            <button class="btn btn-success" onclick="app.uploadManualWords()">
                                <i class="fas fa-upload"></i>
                                上传单词
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-file-code"></i>
                                数据格式说明
                            </h3>
                        </div>
                        <div style="padding: 20px;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                                <div>
                                    <h4 style="margin-bottom: 15px; color: var(--dark);">支持格式</h4>
                                    <div style="background: var(--gray-lighter); padding: 15px; border-radius: var(--border-radius-sm);">
                                        <div style="font-family: monospace; margin-bottom: 10px;">
                                            <span style="color: var(--teacher-primary);">apple</span> | 
                                            <span style="color: var(--accent);">苹果</span>
                                        </div>
                                        <div style="font-family: monospace; margin-bottom: 10px;">
                                            <span style="color: var(--teacher-primary);">"good morning"</span> | 
                                            <span style="color: var(--accent);">早上好</span> | 
                                            <span style="color: #b38c00;">短语</span>
                                        </div>
                                        <div style="font-family: monospace;">
                                            <span style="color: var(--teacher-primary);">run</span> | 
                                            <span style="color: var(--accent);">跑</span> | 
                                            <span style="color: #b38c00;">(不规则动词)</span> | 
                                            <span style="color: var(--gray);">He runs very fast.</span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 style="margin-bottom: 15px; color: var(--dark);">注意事项</h4>
                                    <ul style="color: var(--gray); line-height: 1.6; padding-left: 20px;">
                                        <li>使用竖线"|"分隔不同字段</li>
                                        <li>短语用英文引号""包裹</li>
                                        <li>功能注释用(括号)表示</li>
                                        <li>备注会单独显示一行</li>
                                        <li>闪卡显示：第一行英文，第二行备注</li>
                                        <li>单词表显示：备注单独一行</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // ==================== 工具方法 ====================

            // 显示加载遮罩
            showLoading() {
                document.getElementById('loadingOverlay').classList.add('active');
            }

            // 隐藏加载遮罩
            hideLoading() {
                document.getElementById('loadingOverlay').classList.remove('active');
            }

            // 显示提示消息
            showAlert(message, type = 'info') {
                const alert = document.createElement('div');
                alert.className = `alert alert-${type}`;
                alert.innerHTML = `
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                    <span>${message}</span>
                    <button class="alert-close" onclick="this.parentElement.remove()">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                document.getElementById('mainContent').insertBefore(alert, document.getElementById('mainContent').firstChild);
                
                setTimeout(() => {
                    if (alert.parentElement) {
                        alert.remove();
                    }
                }, 5000);
            }

            // 打开模态框
            openModal(content) {
                const modal = document.getElementById('modal');
                const modalContent = document.getElementById('modalContent');
                modalContent.innerHTML = content;
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            // 关闭模态框
            closeModal() {
                const modal = document.getElementById('modal');
                modal.classList.remove('active');
                document.body.style.overflow = '';
            }

            // 渲染难度星星
            renderDifficultyStars(difficulty) {
                const stars = [];
                for (let i = 1; i <= 3; i++) {
                    if (i <= difficulty) {
                        stars.push('<i class="fas fa-star" style="color: #FFD166;"></i>');
                    } else {
                        stars.push('<i class="far fa-star" style="color: var(--gray-light);"></i>');
                    }
                }
                return stars.join('');
            }

            // 获取难度文本
            getDifficultyText(difficulty) {
                switch(difficulty) {
                    case 1: return '简单';
                    case 2: return '中等';
                    case 3: return '困难';
                    default: return '未知';
                }
            }

            // 获取连续学习排行榜
            getTopStudentsByStreak(count) {
                return [...this.students]
                    .sort((a, b) => b.streakDays - a.streakDays)
                    .slice(0, count);
            }

            // ==================== 学生相关方法 ====================

            // 显示学生详情模态框
            showStudentDetail(studentId) {
                const student = this.students.find(s => s.id === studentId);
                if (!student) return;

                const content = `
                    <div class="modal-header">
                        <h2 class="modal-title">学生详情 - ${student.name}</h2>
                        <p class="modal-subtitle">ID: ${student.id} | ${student.grade} | 加入日期: ${student.joinDate}</p>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <div style="display: flex; gap: 30px; margin-bottom: 25px;">
                            <div style="text-align: center;">
                                <div style="font-size: 48px; font-weight: 800; color: var(--teacher-primary);">${student.streakDays}</div>
                                <div style="color: var(--gray);">连续学习天数</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 48px; font-weight: 800; color: var(--accent);">${student.totalHours}</div>
                                <div style="color: var(--gray);">总学习时长(小时)</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 48px; font-weight: 800; color: var(--accent);">${student.avgAccuracy}%</div>
                                <div style="color: var(--gray);">平均正确率</div>
                            </div>
                        </div>
                        
                        <div style="background: var(--gray-lighter); padding: 20px; border-radius: var(--border-radius-sm); margin-bottom: 25px;">
                            <div style="font-weight: 600; margin-bottom: 15px;">单词掌握情况</div>
                            <div style="display: flex; gap: 20px;">
                                <div style="flex: 1; text-align: center; cursor: pointer;" onclick="app.showStudentWords('${student.id}', 'mastered')">
                                    <div style="font-size: 32px; font-weight: 800; color: var(--accent);">${student.mastered}</div>
                                    <div style="color: var(--gray);">已掌握</div>
                                </div>
                                <div style="flex: 1; text-align: center; cursor: pointer;" onclick="app.showStudentWords('${student.id}', 'fuzzy')">
                                    <div style="font-size: 32px; font-weight: 800; color: var(--secondary);">${student.fuzzy}</div>
                                    <div style="color: var(--gray);">模糊</div>
                                </div>
                                <div style="flex: 1; text-align: center; cursor: pointer;" onclick="app.showStudentWords('${student.id}', 'forgotten')">
                                    <div style="font-size: 32px; font-weight: 800; color: var(--danger);">${student.forgotten}</div>
                                    <div style="color: var(--gray);">没印象</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <div style="font-weight: 600; margin-bottom: 15px;">最近学习活动</div>
                            ${student.recentActivity.map(activity => `
                                <div style="display: flex; justify-content: space-between; padding: 12px; background: white; border: 1px solid var(--gray-light); border-radius: var(--border-radius-sm); margin-bottom: 10px;">
                                    <div>
                                        <div style="font-weight: 600;">${activity.date}</div>
                                        <div style="color: var(--gray); font-size: 13px;">${activity.words}个单词 | ${activity.time} | 正确率${activity.accuracy}%</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-outline" onclick="app.closeModal()">关闭</button>
                        <button class="btn" onclick="app.praiseStudent('${student.id}')">
                            <i class="fas fa-thumbs-up"></i>
                            发送表扬
                        </button>
                        <button class="btn btn-success" onclick="app.sendReminder('${student.id}')">
                            <i class="fas fa-bell"></i>
                            发送提醒
                        </button>
                    </div>
                `;

                this.openModal(content);
            }

            // 显示学生单词列表
            showStudentWords(studentId, type) {
                const student = this.students.find(s => s.id === studentId);
                if (!student) return;

                const typeMap = {
                    'mastered': { title: '已掌握', color: 'var(--accent)', count: student.mastered },
                    'fuzzy': { title: '模糊', color: 'var(--secondary)', count: student.fuzzy },
                    'forgotten': { title: '没印象', color: 'var(--danger)', count: student.forgotten }
                };

                const typeInfo = typeMap[type];
                const sampleWords = this.words.slice(0, Math.min(10, typeInfo.count));

                const content = `
                    <div class="modal-header">
                        <h2 class="modal-title">${student.name} - ${typeInfo.title}单词</h2>
                        <p class="modal-subtitle">共${typeInfo.count}个单词</p>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>英文单词</th>
                                        <th>中文释义</th>
                                        <th>备注</th>
                                        <th>难易度</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${sampleWords.map(word => `
                                        <tr>
                                            <td>${word.english}</td>
                                            <td>${word.chinese}</td>
                                            <td>${word.note || '-'}</td>
                                            <td>
                                                <div style="display: flex; align-items: center; gap: 5px;">
                                                    ${this.renderDifficultyStars(word.difficulty)}
                                                </div>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        
                        ${typeInfo.count > 10 ? `
                            <div style="text-align: center; margin-top: 20px; color: var(--gray);">
                                还有${typeInfo.count - 10}个单词未显示...
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-outline" onclick="app.closeModal()">关闭</button>
                        <button class="btn" onclick="app.exportStudentWords('${student.id}', '${type}')">
                            <i class="fas fa-download"></i>
                            导出列表
                        </button>
                    </div>
                `;

                this.openModal(content);
            }

            // 表扬学生
            praiseStudent(studentId) {
                const student = this.students.find(s => s.id === studentId);
                if (!student) return;

                const content = `
                    <div class="modal-header">
                        <h2 class="modal-title">表扬学生 - ${student.name}</h2>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <div class="form-group">
                            <label>表扬类型</label>
                            <select id="praiseType" class="form-control">
                                <option value="streak">连续学习坚持奖</option>
                                <option value="early">今日最早完成奖</option>
                                <option value="progress">进步最快奖</option>
                                <option value="mastery">单词掌握大师奖</option>
                                <option value="custom">自定义表扬</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>鼓励语</label>
                            <textarea id="praiseMessage" rows="4" placeholder="输入鼓励的话语...">太棒了！你的坚持令人钦佩！</textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="checkbox-item">
                                <input type="checkbox" id="addBadge" checked>
                                <span>附带特殊徽章（24小时有效）</span>
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="broadcast">
                                <span>全班级广播显示</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-outline" onclick="app.closeModal()">取消</button>
                        <button class="btn btn-success" onclick="app.sendPraise('${student.id}')">
                            <i class="fas fa-paper-plane"></i>
                            发送表扬
                        </button>
                    </div>
                `;

                this.openModal(content);
            }

            // 发送表扬
            sendPraise(studentId) {
                const message = document.getElementById('praiseMessage').value;
                const addBadge = document.getElementById('addBadge').checked;
                const broadcast = document.getElementById('broadcast').checked;
                
                this.showAlert('表扬已成功发送给学生！', 'success');
                this.closeModal();
            }

            // 发送提醒
            sendReminder(studentId) {
                const student = this.students.find(s => s.id === studentId);
                if (!student) return;

                const content = `
                    <div class="modal-header">
                        <h2 class="modal-title">发送提醒 - ${student.name}</h2>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <div class="form-group">
                            <label>提醒类型</label>
                            <select id="reminderType" class="form-control">
                                <option value="daily">每日学习提醒</option>
                                <option value="streak">连续天数提醒</option>
                                <option value="review">复习提醒</option>
                                <option value="custom">自定义提醒</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>提醒内容</label>
                            <textarea id="reminderMessage" rows="4" placeholder="输入提醒内容...">记得完成今日的单词学习哦！</textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>发送时间</label>
                            <input type="datetime-local" id="reminderTime" value="${this.getTomorrowDate()}">
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-outline" onclick="app.closeModal()">取消</button>
                        <button class="btn btn-success" onclick="app.sendReminderNow('${student.id}')">
                            <i class="fas fa-bell"></i>
                            发送提醒
                        </button>
                    </div>
                `;

                this.openModal(content);
            }

            // 获取明天日期
            getTomorrowDate() {
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                tomorrow.setHours(18, 0, 0, 0);
                return tomorrow.toISOString().slice(0, 16);
            }

            // 发送提醒
            sendReminderNow(studentId) {
                this.showAlert('提醒已成功设置！', 'success');
                this.closeModal();
            }

            // 显示添加学生模态框
            showAddStudentModal() {
                const content = `
                    <div class="modal-header">
                        <h2 class="modal-title">添加新学生</h2>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <div class="form-group">
                            <label>学生姓名</label>
                            <input type="text" id="studentName" placeholder="请输入学生姓名">
                        </div>
                        
                        <div class="form-group">
                            <label>年级</label>
                            <select id="studentGrade" class="form-control">
                                <option value="一年级">一年级</option>
                                <option value="二年级">二年级</option>
                                <option value="三年级">三年级</option>
                                <option value="四年级">四年级</option>
                                <option value="五年级">五年级</option>
                                <option value="六年级">六年级</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>初始学习分组</label>
                            <div class="checkbox-group">
                                <label class="checkbox-item">
                                    <input type="checkbox" id="groupCore" checked>
                                    <span>核心词汇800</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" id="groupDaily">
                                    <span>日常用语200</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" id="groupExam">
                                    <span>考试必备500</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-outline" onclick="app.closeModal()">取消</button>
                        <button class="btn btn-success" onclick="app.addStudent()">
                            <i class="fas fa-plus"></i>
                            添加学生
                        </button>
                    </div>
                `;

                this.openModal(content);
            }

            // 添加学生
            addStudent() {
                const name = document.getElementById('studentName').value.trim();
                const grade = document.getElementById('studentGrade').value;
                
                if (!name) {
                    this.showAlert('请输入学生姓名', 'error');
                    return;
                }
                
                // 生成学生ID
                const studentId = 'S' + new Date().getTime().toString().slice(-6) + Math.random().toString(36).substr(2, 3).toUpperCase();
                
                // 创建新学生对象
                const newStudent = {
                    id: studentId,
                    name: name,
                    grade: grade,
                    lastLogin: '从未登录',
                    streakDays: 0,
                    todayDone: false,
                    mastered: 0,
                    fuzzy: 0,
                    forgotten: 0,
                    joinDate: new Date().toLocaleDateString('zh-CN'),
                    totalHours: 0,
                    avgAccuracy: 0,
                    recentActivity: []
                };
                
                this.students.push(newStudent);
                document.getElementById('studentCount').textContent = this.students.length;
                
                this.showAlert(`学生"${name}"添加成功！`, 'success');
                this.closeModal();
                this.loadPage('students');
            }

            // 编辑学生
            editStudent(studentId) {
                const student = this.students.find(s => s.id === studentId);
                if (!student) return;

                const content = `
                    <div class="modal-header">
                        <h2 class="modal-title">编辑学生信息 - ${student.name}</h2>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <div class="form-group">
                            <label>学生姓名</label>
                            <input type="text" id="editStudentName" value="${student.name}">
                        </div>
                        
                        <div class="form-group">
                            <label>年级</label>
                            <select id="editStudentGrade" class="form-control">
                                <option value="一年级" ${student.grade === '一年级' ? 'selected' : ''}>一年级</option>
                                <option value="二年级" ${student.grade === '二年级' ? 'selected' : ''}>二年级</option>
                                <option value="三年级" ${student.grade === '三年级' ? 'selected' : ''}>三年级</option>
                                <option value="四年级" ${student.grade === '四年级' ? 'selected' : ''}>四年级</option>
                                <option value="五年级" ${student.grade === '五年级' ? 'selected' : ''}>五年级</option>
                                <option value="六年级" ${student.grade === '六年级' ? 'selected' : ''}>六年级</option>
                            </select>
                        </div>
                        
                        <div class="alert alert-warning">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>注意：修改学生信息不会影响学习记录</span>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-outline" onclick="app.closeModal()">取消</button>
                        <button class="btn btn-danger" onclick="app.resetStudentProgress('${student.id}')">
                            <i class="fas fa-redo"></i>
                            重置进度
                        </button>
                        <button class="btn btn-success" onclick="app.saveStudentChanges('${student.id}')">
                            <i class="fas fa-save"></i>
                            保存更改
                        </button>
                    </div>
                `;

                this.openModal(content);
            }

            // 保存学生更改
            saveStudentChanges(studentId) {
                const student = this.students.find(s => s.id === studentId);
                if (!student) return;

                student.name = document.getElementById('editStudentName').value.trim();
                student.grade = document.getElementById('editStudentGrade').value;
                
                this.showAlert('学生信息更新成功！', 'success');
                this.closeModal();
                this.loadPage('students');
            }

            // 重置学生进度
            resetStudentProgress(studentId) {
                if (!confirm('确定要重置该学生的学习进度吗？此操作不可撤销！')) {
                    return;
                }
                
                const student = this.students.find(s => s.id === studentId);
                if (!student) return;

                student.mastered = 0;
                student.fuzzy = 0;
                student.forgotten = 0;
                student.streakDays = 0;
                student.totalHours = 0;
                student.avgAccuracy = 0;
                student.recentActivity = [];
                
                this.showAlert('学生进度已重置！', 'success');
                this.closeModal();
                this.loadPage('students');
            }

            // ==================== 单词相关方法 ====================

            // 排序单词
            sortWords(words, order) {
                return [...words].sort((a, b) => {
                    switch(order) {
                        case 'time':
                            return new Date(b.created) - new Date(a.created);
                        case 'a-z':
                            return a.english.localeCompare(b.english);
                        case 'difficulty':
                            return a.difficulty - b.difficulty;
                        default:
                            return 0;
                    }
                });
            }

            // 改变单词排序方式
            changeWordSort(order) {
                this.wordSortOrder = order;
                this.loadPage('words');
            }

            // 编辑单词
            editWord(wordId) {
                const word = this.words.find(w => w.id === wordId);
                if (!word) return;

                const content = `
                    <div class="modal-header">
                        <h2 class="modal-title">编辑单词 - ${word.english}</h2>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <div class="form-row">
                            <div class="form-group">
                                <label>英文</label>
                                <input type="text" id="editEnglish" value="${word.english}">
                            </div>
                            <div class="form-group">
                                <label>中文</label>
                                <input type="text" id="editChinese" value="${word.chinese}">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>备注</label>
                            <input type="text" id="editNote" value="${word.note || ''}" placeholder="如：(复数)、(不规则动词)、(短语)">
                            <div class="form-hint">备注会单独显示一行，用(括号)表示功能注释</div>
                        </div>
                        
                        <div class="form-group">
                            <label>例句</label>
                            <input type="text" id="editExample" value="${word.example || ''}" placeholder="输入例句">
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>难易度</label>
                                <select id="editDifficulty" class="form-control">
                                    <option value="1" ${word.difficulty === 1 ? 'selected' : ''}>简单</option>
                                    <option value="2" ${word.difficulty === 2 ? 'selected' : ''}>中等</option>
                                    <option value="3" ${word.difficulty === 3 ? 'selected' : ''}>困难</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>分组</label>
                                <select id="editGroup" class="form-control">
                                    <option value="核心词汇800" ${word.group === '核心词汇800' ? 'selected' : ''}>核心词汇800</option>
                                    <option value="日常用语200" ${word.group === '日常用语200' ? 'selected' : ''}>日常用语200</option>
                                    <option value="考试必备500" ${word.group === '考试必备500' ? 'selected' : ''}>考试必备500</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-outline" onclick="app.closeModal()">取消</button>
                        <button class="btn btn-success" onclick="app.saveWordChanges(${word.id})">
                            <i class="fas fa-save"></i>
                            保存更改
                        </button>
                    </div>
                `;

                this.openModal(content);
            }

            // 保存单词更改
            saveWordChanges(wordId) {
                const word = this.words.find(w => w.id === wordId);
                if (!word) return;

                word.english = document.getElementById('editEnglish').value.trim();
                word.chinese = document.getElementById('editChinese').value.trim();
                word.note = document.getElementById('editNote').value.trim();
                word.example = document.getElementById('editExample').value.trim();
                word.difficulty = parseInt(document.getElementById('editDifficulty').value);
                word.group = document.getElementById('editGroup').value;

                this.showAlert('单词信息更新成功！', 'success');
                this.closeModal();
                this.loadPage('words');
            }

            // 删除单词
            deleteWord(wordId) {
                if (!confirm('确定要删除这个单词吗？此操作不可撤销！')) {
                    return;
                }

                this.words = this.words.filter(w => w.id !== wordId);
                document.getElementById('wordCount').textContent = this.words.length;
                
                this.showAlert('单词删除成功！', 'success');
                this.loadPage('words');
            }

            // 导出单词
            exportWords() {
                const csvContent = "data:text/csv;charset=utf-8," 
                    + "英文,中文,备注,难易度,分组,例句\n"
                    + this.words.map(word => 
                        `"${word.english}","${word.chinese}","${word.note || ''}",${word.difficulty},"${word.group}","${word.example || ''}"`
                    ).join("\n");
                
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", `单词列表_${new Date().toISOString().slice(0,10)}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                this.showAlert('单词列表导出成功！', 'success');
            }

            // ==================== 上传相关方法 ====================

            // 设置上传事件
            setupUploadEvents() {
                const fileUpload = document.getElementById('fileUpload');
                const fileInput = document.getElementById('fileInput');
                const wordGroup = document.getElementById('wordGroup');
                const customGroupContainer = document.getElementById('customGroupContainer');

                // 文件拖放
                fileUpload.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    fileUpload.classList.add('dragover');
                });

                fileUpload.addEventListener('dragleave', () => {
                    fileUpload.classList.remove('dragover');
                });

                fileUpload.addEventListener('drop', (e) => {
                    e.preventDefault();
                    fileUpload.classList.remove('dragover');
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        this.processUploadedFile(files[0]);
                    }
                });

                // 文件选择
                fileInput.addEventListener('change', (e) => {
                    if (e.target.files.length > 0) {
                        this.processUploadedFile(e.target.files[0]);
                    }
                });

                // 自定义分组显示
                wordGroup.addEventListener('change', () => {
                    if (wordGroup.value === '自定义分组') {
                        customGroupContainer.style.display = 'block';
                    } else {
                        customGroupContainer.style.display = 'none';
                    }
                });
            }

            // 处理上传的文件
            processUploadedFile(file) {
                const reader = new FileReader();
                
                reader.onload = (e) => {
                    const content = e.target.result;
                    this.processWordData(content);
                };
                
                reader.readAsText(file);
            }

            // 处理单词数据
            processWordData(content) {
                this.showLoading();
                
                try {
                    const lines = content.split('\n').filter(line => line.trim());
                    const newWords = [];
                    
                    for (const line of lines) {
                        const parts = line.split('|').map(part => part.trim());
                        if (parts.length >= 2) {
                            const english = parts[0];
                            const chinese = parts[1];
                            const note = parts[2] || '';
                            const example = parts[3] || '';
                            
                            // 计算难度
                            const difficulty = this.calculateWordDifficulty(english, note);
                            
                            // 获取分组
                            const groupSelect = document.getElementById('wordGroup');
                            let group = groupSelect.value;
                            if (group === '自定义分组') {
                                const customGroup = document.getElementById('customGroupName').value.trim();
                                group = customGroup || '未分组';
                            }
                            
                            newWords.push({
                                id: this.words.length + newWords.length + 1,
                                english: english,
                                chinese: chinese,
                                note: note,
                                example: example,
                                difficulty: difficulty,
                                created: new Date().toISOString().slice(0, 10),
                                group: group,
                                masteredCount: 0
                            });
                        }
                    }
                    
                    if (newWords.length > 0) {
                        this.words.push(...newWords);
                        document.getElementById('wordCount').textContent = this.words.length;
                        
                        const content = `
                            <div class="modal-header">
                                <h2 class="modal-title">上传结果</h2>
                            </div>
                            
                            <div style="margin-bottom: 30px;">
                                <div class="alert alert-success">
                                    <i class="fas fa-check-circle"></i>
                                    <span>成功上传 ${newWords.length} 个单词！</span>
                                </div>
                                
                                <div style="max-height: 300px; overflow-y: auto;">
                                    <table style="width: 100%;">
                                        <thead>
                                            <tr>
                                                <th>英文</th>
                                                <th>中文</th>
                                                <th>备注</th>
                                                <th>难易度</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${newWords.slice(0, 10).map(word => `
                                                <tr>
                                                    <td>${word.english}</td>
                                                    <td>${word.chinese}</td>
                                                    <td>${word.note || '-'}</td>
                                                    <td>${this.getDifficultyText(word.difficulty)}</td>
                                                </tr>
                                            `).join('')}
                                        </tbody>
                                    </table>
                                    
                                    ${newWords.length > 10 ? `
                                        <div style="text-align: center; margin-top: 10px; color: var(--gray);">
                                            还有${newWords.length - 10}个单词未显示...
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                            
                            <div class="modal-footer">
                                <button class="btn btn-success" onclick="app.closeModal(); app.loadPage('words');">
                                    <i class="fas fa-eye"></i>
                                    查看所有单词
                                </button>
                            </div>
                        `;
                        
                        this.openModal(content);
                    } else {
                        this.showAlert('未找到有效的单词数据', 'error');
                    }
                    
                } catch (error) {
                    this.showAlert('文件处理失败: ' + error.message, 'error');
                } finally {
                    this.hideLoading();
                }
            }

            // 计算单词难度
            calculateWordDifficulty(english, note) {
                let score = 0;
                
                // 长度因素
                const length = english.replace(/[^a-zA-Z]/g, '').length;
                if (length <= 4) score += 1;
                else if (length <= 6) score += 2;
                else score += 3;
                
                // 短语因素
                if (english.includes(' ')) score += 1;
                
                // 引号中的短语
                if (english.startsWith('"') && english.endsWith('"')) score += 1;
                
                // 备注因素
                if (note.includes('复数') || note.includes('不规则') || note.includes('过去式') || note.includes('短语')) {
                    score += 1;
                }
                
                // 转换为1-3的难度等级
                return Math.min(3, Math.max(1, Math.floor(score / 2)));
            }

            // 手动上传单词
            uploadManualWords() {
                const manualInput = document.getElementById('manualInput').value.trim();
                if (!manualInput) {
                    this.showAlert('请输入单词内容', 'error');
                    return;
                }
                
                this.processWordData(manualInput);
            }

            // ==================== 家长相关方法 ====================

            // 显示创建家长账号模态框
            showCreateParentModal() {
                const content = `
                    <div class="modal-header">
                        <h2 class="modal-title">创建家长账号</h2>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <div class="form-group">
                            <label>家长姓名</label>
                            <input type="text" id="parentName" placeholder="请输入家长姓名">
                        </div>
                        
                        <div class="form-group">
                            <label>手机号</label>
                            <input type="tel" id="parentPhone" placeholder="请输入手机号">
                        </div>
                        
                        <div class="form-group">
                            <label>选择关联学生</label>
                            <div style="max-height: 200px; overflow-y: auto; border: 1px solid var(--gray-light); border-radius: var(--border-radius-sm); padding: 15px;">
                                ${this.students.map(student => `
                                    <label class="checkbox-item">
                                        <input type="checkbox" value="${student.id}">
                                        <span>${student.name} (${student.grade}) - ${student.id}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>账号设置</label>
                            <div class="form-row">
                                <div class="form-group">
                                    <input type="text" id="parentUsername" placeholder="账号" value="parent_">
                                </div>
                                <div class="form-group">
                                    <input type="text" id="parentPassword" placeholder="初始密码" value="123456">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-outline" onclick="app.closeModal()">取消</button>
                        <button class="btn btn-success" onclick="app.createParentAccount()">
                            <i class="fas fa-plus"></i>
                            创建账号
                        </button>
                    </div>
                `;

                this.openModal(content);
            }

            // 创建家长账号
            createParentAccount() {
                const name = document.getElementById('parentName').value.trim();
                const phone = document.getElementById('parentPhone').value.trim();
                const username = document.getElementById('parentUsername').value.trim();
                const password = document.getElementById('parentPassword').value.trim();
                
                if (!name || !phone || !username || !password) {
                    this.showAlert('请填写所有必填项', 'error');
                    return;
                }
                
                // 获取选中的学生
                const selectedStudents = Array.from(document.querySelectorAll('.checkbox-item input:checked'))
                    .map(input => {
                        const studentId = input.value;
                        const student = this.students.find(s => s.id === studentId);
                        return student ? student.name : '';
                    })
                    .filter(name => name);
                
                if (selectedStudents.length === 0) {
                    this.showAlert('请至少选择一个关联学生', 'error');
                    return;
                }
                
                // 创建新家长账号
                const newParent = {
                    id: username,
                    name: name,
                    phone: phone,
                    students: selectedStudents,
                    created: new Date().toLocaleDateString('zh-CN'),
                    lastLogin: '从未登录'
                };
                
                this.parents.push(newParent);
                
                this.showAlert(`家长账号"${username}"创建成功！`, 'success');
                this.closeModal();
                this.loadPage('parents');
            }

            // 查看家长
            viewParent(parentId) {
                const parent = this.parents.find(p => p.id === parentId);
                if (!parent) return;

                const content = `
                    <div class="modal-header">
                        <h2 class="modal-title">家长详情 - ${parent.name}</h2>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <div style="margin-bottom: 25px;">
                            <div style="font-weight: 600; margin-bottom: 10px; color: var(--dark);">账号信息</div>
                            <div style="background: var(--gray-lighter); padding: 15px; border-radius: var(--border-radius-sm);">
                                <div style="display: grid; grid-template-columns: 100px 1fr; gap: 10px; margin-bottom: 10px;">
                                    <div style="color: var(--gray);">账号:</div>
                                    <div style="font-weight: 600;">${parent.id}</div>
                                </div>
                                <div style="display: grid; grid-template-columns: 100px 1fr; gap: 10px; margin-bottom: 10px;">
                                    <div style="color: var(--gray);">手机号:</div>
                                    <div>${parent.phone}</div>
                                </div>
                                <div style="display: grid; grid-template-columns: 100px 1fr; gap: 10px;">
                                    <div style="color: var(--gray);">创建时间:</div>
                                    <div>${parent.created}</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <div style="font-weight: 600; margin-bottom: 10px; color: var(--dark);">关联学生</div>
                            <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                                ${parent.students.map(studentName => `
                                    <span class="status-badge status-info">${studentName}</span>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <div style="font-weight: 600; margin-bottom: 10px; color: var(--dark);">可查看内容</div>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                <div style="background: rgba(79, 106, 245, 0.1); padding: 15px; border-radius: var(--border-radius-sm);">
                                    <div style="font-weight: 600; color: var(--teacher-primary); margin-bottom: 5px;">每日打卡情况</div>
                                    <div style="font-size: 13px; color: var(--gray);">查看孩子的每日学习完成情况</div>
                                </div>
                                <div style="background: rgba(6, 214, 160, 0.1); padding: 15px; border-radius: var(--border-radius-sm);">
                                    <div style="font-weight: 600; color: var(--accent); margin-bottom: 5px;">已学单词</div>
                                    <div style="font-size: 13px; color: var(--gray);">查看孩子掌握、模糊、没印象的单词</div>
                                </div>
                                <div style="background: rgba(255, 209, 102, 0.1); padding: 15px; border-radius: var(--border-radius-sm);">
                                    <div style="font-weight: 600; color: #b38c00; margin-bottom: 5px;">连续学习榜</div>
                                    <div style="font-size: 13px; color: var(--gray);">查看孩子的连续学习天数</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-outline" onclick="app.closeModal()">关闭</button>
                        <button class="btn" onclick="app.resetParentPassword('${parent.id}')">
                            <i class="fas fa-key"></i>
                            重置密码
                        </button>
                        <button class="btn btn-success" onclick="app.sendParentInvitation('${parent.id}')">
                            <i class="fas fa-paper-plane"></i>
                            发送邀请
                        </button>
                    </div>
                `;

                this.openModal(content);
            }

            // 重置家长密码
            resetParentPassword(parentId) {
                const newPassword = Math.random().toString(36).slice(-8);
                this.showAlert(`密码已重置为: ${newPassword}`, 'success');
            }

            // 发送家长邀请
            sendParentInvitation(parentId) {
                this.showAlert('邀请已发送到家长手机！', 'success');
            }

            // 编辑家长
            editParent(parentId) {
                this.showAlert('编辑功能开发中...', 'info');
            }

            // 删除家长
            deleteParent(parentId) {
                if (!confirm('确定要删除这个家长账号吗？此操作不可撤销！')) {
                    return;
                }

                this.parents = this.parents.filter(p => p.id !== parentId);
                this.showAlert('家长账号删除成功！', 'success');
                this.loadPage('parents');
            }

            // 显示家长指南
            showParentGuide() {
                const content = `
                    <div class="modal-header">
                        <h2 class="modal-title">家长账号使用指南</h2>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <div style="margin-bottom: 25px;">
                            <div style="font-weight: 600; margin-bottom: 15px; color: var(--dark);">家长端功能说明</div>
                            <div style="background: var(--gray-lighter); padding: 20px; border-radius: var(--border-radius-sm);">
                                <div style="display: flex; align-items: start; gap: 15px; margin-bottom: 15px;">
                                    <div style="width: 40px; height: 40px; background: var(--teacher-primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        1
                                    </div>
                                    <div>
                                        <div style="font-weight: 600; margin-bottom: 5px;">查看学习进度</div>
                                        <div style="color: var(--gray); font-size: 14px;">家长可以查看孩子的每日打卡情况、学习时长、掌握单词数</div>
                                    </div>
                                </div>
                                
                                <div style="display: flex; align-items: start; gap: 15px; margin-bottom: 15px;">
                                    <div style="width: 40px; height: 40px; background: var(--accent); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        2
                                    </div>
                                    <div>
                                        <div style="font-weight: 600; margin-bottom: 5px;">单词掌握情况</div>
                                        <div style="color: var(--gray); font-size: 14px;">按"已掌握"、"模糊"、"没印象"分类查看孩子的单词学习情况</div>
                                    </div>
                                </div>
                                
                                <div style="display: flex; align-items: start; gap: 15px;">
                                    <div style="width: 40px; height: 40px; background: var(--secondary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        3
                                    </div>
                                    <div>
                                        <div style="font-weight: 600; margin-bottom: 5px;">发送鼓励</div>
                                        <div style="color: var(--gray); font-size: 14px;">家长可以给孩子发送鼓励消息，激励孩子坚持学习</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <div style="font-weight: 600; margin-bottom: 10px; color: var(--dark);">账号信息</div>
                            <div style="background: white; border: 1px solid var(--gray-light); border-radius: var(--border-radius-sm); padding: 15px;">
                                <div style="font-family: monospace; background: var(--gray-lighter); padding: 10px; border-radius: 4px; margin-bottom: 10px;">
                                    登录网址: https://your-domain.com/parent.html
                                </div>
                                <div style="font-family: monospace; background: var(--gray-lighter); padding: 10px; border-radius: 4px;">
                                    账号格式: parent_家长姓名
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button class="btn btn-success" onclick="app.closeModal()">
                            我知道了
                        </button>
                    </div>
                `;

                this.openModal(content);
            }

            // ==================== 统计相关方法 ====================

            // 生成活动报告
            generateActivityReport() {
                const reportData = {
                    date: new Date().toLocaleDateString('zh-CN'),
                    totalStudents: this.students.length,
                    completedToday: this.students.filter(s => s.todayDone).length,
                    completionRate: Math.round((this.students.filter(s => s.todayDone).length / this.students.length) * 100),
                    avgStreak: Math.round(this.students.reduce((sum, s) => sum + s.streakDays, 0) / this.students.length),
                    topStudents: this.getTopStudentsByStreak(5)
                };
                
                const reportContent = `
                    ===== 单词大师训练营 - 活跃度报告 =====
                    
                    报告日期: ${reportData.date}
                    总学生数: ${reportData.totalStudents}
                    今日完成: ${reportData.completedToday}
                    打卡率: ${reportData.completionRate}%
                    平均连续天数: ${reportData.avgStreak}
                    
                    === 连续学习排行榜 ===
                    ${reportData.topStudents.map((s, i) => 
                        `${i+1}. ${s.name} - ${s.streakDays}天`
                    ).join('\n')}
                    
                    === 详细数据 ===
                    ${this.students.map(s => 
                        `${s.name}: 连续${s.streakDays}天 | 今日${s.todayDone ? '完成' : '未完成'} | 掌握${s.mastered}词 | 模糊${s.fuzzy}词 | 没印象${s.forgotten}词`
                    ).join('\n')}
                `;
                
                const blob = new Blob([reportContent], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `活跃度报告_${new Date().toISOString().slice(0,10)}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                this.showAlert('活跃度报告导出成功！', 'success');
            }

            // 生成报告
            generateReport() {
                this.generateActivityReport();
            }

            // ==================== 其他方法 ====================

            // 导出学生单词列表
            exportStudentWords(studentId, type) {
                const student = this.students.find(s => s.id === studentId);
                const typeMap = {
                    'mastered': '已掌握',
                    'fuzzy': '模糊',
                    'forgotten': '没印象'
                };
                
                const content = `${student.name} - ${typeMap[type]}单词列表\n\n` +
                    this.words.slice(0, 10).map(word => 
                        `${word.english} | ${word.chinese} | ${word.note || ''}`
                    ).join('\n');
                
                const blob = new Blob([content], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${student.name}_${typeMap[type]}_单词列表.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                this.showAlert('单词列表导出成功！', 'success');
            }

            // 设置学生页面事件
            setupStudentsEvents() {
                const searchInput = document.getElementById('studentSearch');
                const filterSelect = document.getElementById('studentFilter');
                
                if (searchInput) {
                    searchInput.addEventListener('input', () => {
                        this.filterStudents();
                    });
                }
                
                if (filterSelect) {
                    filterSelect.addEventListener('change', () => {
                        this.filterStudents();
                    });
                }
            }

            // 过滤学生
            filterStudents() {
                // 这里可以实现学生过滤逻辑
                this.showAlert('搜索功能开发中...', 'info');
            }

            // 设置单词页面事件
            setupWordsEvents() {
                const searchInput = document.getElementById('wordSearch');
                const filterSelect = document.getElementById('wordGroupFilter');
                
                if (searchInput) {
                    searchInput.addEventListener('input', () => {
                        this.filterWords();
                    });
                }
                
                if (filterSelect) {
                    filterSelect.addEventListener('change', () => {
                        this.filterWords();
                    });
                }
            }

            // 过滤单词
            filterWords() {
                // 这里可以实现单词过滤逻辑
                this.showAlert('筛选功能开发中...', 'info');
            }

            // 设置家长页面事件
            setupParentsEvents() {
                const searchInput = document.getElementById('parentSearch');
                
                if (searchInput) {
                    searchInput.addEventListener('input', () => {
                        this.filterParents();
                    });
                }
            }

            // 过滤家长
            filterParents() {
                // 这里可以实现家长过滤逻辑
                this.showAlert('搜索功能开发中...', 'info');
            }

            // 设置统计页面事件
            setupAnalyticsEvents() {
                const tabs = document.querySelectorAll('.tab[data-tab]');
                tabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabName = tab.dataset.tab;
                        
                        // 更新标签页状态
                        tabs.forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');
                        
                        // 切换内容
                        this.switchAnalyticsTab(tabName);
                    });
                });
            }

            // 切换统计标签页
            switchAnalyticsTab(tabName) {
                const content = document.getElementById('analyticsContent');
                
                switch(tabName) {
                    case 'overview':
                        // 总览已经在初始渲染中显示
                        break;
                    case 'activity':
                        content.innerHTML = `
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fas fa-chart-line"></i>
                                        学生活跃度分析
                                    </h3>
                                </div>
                                <div style="padding: 20px;">
                                    <div style="margin-bottom: 25px;">
                                        <div style="font-weight: 600; margin-bottom: 15px; color: var(--dark);">每日活跃时间分布</div>
                                        <div style="background: var(--gray-lighter); padding: 20px; border-radius: var(--border-radius-sm);">
                                            <!-- 这里可以添加更详细的图表 -->
                                            <div style="text-align: center; padding: 40px 20px; color: var(--gray);">
                                                <i class="fas fa-chart-bar" style="font-size: 48px; margin-bottom: 15px;"></i>
                                                <div>详细图表功能开发中...</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                        break;
                    case 'progress':
                        content.innerHTML = `
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fas fa-trending-up"></i>
                                        学生进步分析
                                    </h3>
                                </div>
                                <div style="padding: 20px;">
                                    <div style="margin-bottom: 25px;">
                                        <div style="font-weight: 600; margin-bottom: 15px; color: var(--dark);">单词掌握进步曲线</div>
                                        <div style="background: var(--gray-lighter); padding: 20px; border-radius: var(--border-radius-sm);">
                                            <!-- 这里可以添加进步曲线图表 -->
                                            <div style="text-align: center; padding: 40px 20px; color: var(--gray);">
                                                <i class="fas fa-chart-line" style="font-size: 48px; margin-bottom: 15px;"></i>
                                                <div>进步分析功能开发中...</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                        break;
                    case 'export':
                        content.innerHTML = `
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fas fa-file-export"></i>
                                        数据导出
                                    </h3>
                                </div>
                                <div style="padding: 20px;">
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                                        <div class="card" style="text-align: center; cursor: pointer;" onclick="app.exportWords()">
                                            <div style="font-size: 48px; color: var(--teacher-primary); margin-bottom: 15px;">
                                                <i class="fas fa-book"></i>
                                            </div>
                                            <div style="font-weight: 600; margin-bottom: 10px;">导出单词库</div>
                                            <div style="color: var(--gray); font-size: 14px;">导出所有单词数据</div>
                                        </div>
                                        
                                        <div class="card" style="text-align: center; cursor: pointer;" onclick="app.exportStudentData()">
                                            <div style="font-size: 48px; color: var(--accent); margin-bottom: 15px;">
                                                <i class="fas fa-user-graduate"></i>
                                            </div>
                                            <div style="font-weight: 600; margin-bottom: 10px;">导出学生数据</div>
                                            <div style="color: var(--gray); font-size: 14px;">导出所有学生学习数据</div>
                                        </div>
                                        
                                        <div class="card" style="text-align: center; cursor: pointer;" onclick="app.generateActivityReport()">
                                            <div style="font-size: 48px; color: var(--secondary); margin-bottom: 15px;">
                                                <i class="fas fa-chart-bar"></i>
                                            </div>
                                            <div style="font-weight: 600; margin-bottom: 10px;">导出活跃度报告</div>
                                            <div style="color: var(--gray); font-size: 14px;">生成详细的活动报告</div>
                                        </div>
                                    </div>
                                    
                                    <div class="alert alert-info">
                                        <i class="fas fa-info-circle"></i>
                                        <span>导出文件格式为CSV或TXT，可在Excel中打开查看</span>
                                    </div>
                                </div>
                            </div>
                        `;
                        break;
                }
            }

            // 导出学生数据
            exportStudentData() {
                const csvContent = "data:text/csv;charset=utf-8," 
                    + "学生ID,姓名,年级,连续天数,已掌握,模糊,没印象,总学习时长,平均正确率,加入日期\n"
                    + this.students.map(student => 
                        `${student.id},${student.name},${student.grade},${student.streakDays},${student.mastered},${student.fuzzy},${student.forgotten},${student.totalHours},${student.avgAccuracy},${student.joinDate}`
                    ).join("\n");
                
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", `学生数据_${new Date().toISOString().slice(0,10)}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                this.showAlert('学生数据导出成功！', 'success');
            }

            // 排序学生
            sortStudents(field) {
                // 这里可以实现学生排序逻辑
                this.showAlert('排序功能开发中...', 'info');
            }
        }

        // ==================== 初始化应用 ====================
        document.addEventListener('DOMContentLoaded', () => {
            // 创建应用实例
            window.app = new TeacherApp();
        });
    </script>
</body>
</html>
