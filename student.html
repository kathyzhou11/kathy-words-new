<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂçïËØçÂ§ßÂ∏àËÆ≠ÁªÉËê• - Â≠¶ÁîüÁ´Ø</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== ÂÖ®Â±ÄÊ†∑Âºè ===== */
        :root {
            --primary: #4F6AF5;
            --primary-light: #6C83F7;
            --secondary: #FFD166;
            --accent: #06D6A0;
            --danger: #EF476F;
            --warning: #FFD166;
            --dark: #2D3047;
            --gray: #8A8FA3;
            --light: #F8F9FA;
            --border-radius: 16px;
            --border-radius-sm: 8px;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: var(--dark);
        }

        /* ===== Â∏ÉÂ±ÄÂÆπÂô® ===== */
        .container {
            display: flex;
            min-height: 100vh;
        }

        /* ===== ‰æßËæπÊ†è ===== */
        .sidebar {
            width: 260px;
            background: linear-gradient(180deg, #FFD166 0%, #ffc043 100%);
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow);
            z-index: 100;
        }

        .user-info {
            padding: 30px 20px;
            text-align: center;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .avatar {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 32px;
            color: var(--primary);
            border: 3px solid var(--primary);
        }

        .user-name {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }

        .user-role {
            display: inline-block;
            padding: 4px 12px;
            background: rgba(255, 255, 255, 0.2);
            color: var(--dark);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .nav-menu {
            flex: 1;
            padding: 20px 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: var(--dark);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--dark);
        }

        .nav-item.active {
            background: rgba(255, 255, 255, 0.15);
            color: var(--dark);
            border-left-color: var(--dark);
            font-weight: 600;
        }

        .nav-item i {
            width: 24px;
            margin-right: 12px;
            font-size: 18px;
        }

        .logout-btn {
            margin: 20px;
            padding: 12px;
            background: rgba(239, 71, 111, 0.1);
            color: var(--danger);
            border: none;
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: rgba(239, 71, 111, 0.2);
        }

        .logout-btn i {
            margin-right: 8px;
        }

        /* ===== ‰∏ªÂÜÖÂÆπÂå∫ ===== */
        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            position: relative;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .page-subtitle {
            color: var(--gray);
            margin-bottom: 30px;
            font-size: 16px;
        }

        /* ===== È°∂ÈÉ®Ê¶úÂçï ===== */
        .leaderboard-floating {
            position: fixed;
            top: 30px;
            right: 30px;
            width: 250px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            z-index: 99;
            overflow: hidden;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .leaderboard-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 12px 15px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .leaderboard-type {
            font-size: 12px;
            opacity: 0.9;
        }

        .leaderboard-refresh {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 4px;
        }

        .leaderboard-content {
            max-height: 320px;
            overflow-y: auto;
        }

        .leaderboard-item {
            padding: 10px 15px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .leaderboard-item.me {
            background: rgba(6, 214, 160, 0.1);
            border-left: 3px solid var(--accent);
        }

        .leaderboard-rank {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 12px;
            margin-right: 10px;
        }

        .rank-1 {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: white;
        }

        .rank-2 {
            background: linear-gradient(135deg, #C0C0C0 0%, #A0A0A0 100%);
            color: white;
        }

        .rank-3 {
            background: linear-gradient(135deg, #CD7F32 0%, #A0522D 100%);
            color: white;
        }

        .rank-other {
            background: rgba(0, 0, 0, 0.05);
            color: var(--gray);
        }

        .leaderboard-name {
            flex: 1;
            font-size: 13px;
            font-weight: 500;
        }

        .leaderboard-score {
            font-weight: 600;
            font-size: 13px;
            color: var(--primary);
        }

        .leaderboard-dots {
            padding: 8px 15px;
            text-align: center;
            color: var(--gray);
            font-size: 12px;
            border-top: 1px solid rgba(0,0,0,0.05);
        }

        /* ===== Âç°ÁâáÁªÑ‰ª∂ ===== */
        .card {
            background: white;
            border-radius: var(--border-radius);
            padding: 24px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--dark);
        }

        .card-icon {
            width: 40px;
            height: 40px;
            background: rgba(79, 106, 245, 0.1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
        }

        /* ===== ÊåâÈíÆÁªÑ‰ª∂ ===== */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .btn:hover {
            background: var(--primary-light);
            transform: translateY(-1px);
        }

        .btn i {
            margin-right: 8px;
        }

        .btn-success {
            background: var(--accent);
        }

        .btn-success:hover {
            background: #05C492;
        }

        .btn-warning {
            background: var(--warning);
            color: var(--dark);
        }

        .btn-warning:hover {
            background: #FFC043;
        }

        .btn-secondary {
            background: var(--gray);
        }

        .btn-secondary:hover {
            background: #7A7F94;
        }

        .action-btn {
            padding: 8px 16px;
            background: rgba(79, 106, 245, 0.1);
            color: var(--primary);
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
        }

        .action-btn:hover {
            background: rgba(79, 106, 245, 0.2);
        }

        .action-btn i {
            margin-right: 6px;
        }

        /* ===== ËøõÂ∫¶Êù° ===== */
        .progress-bar {
            height: 8px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        /* ===== Â≠¶‰π†ËøõÂ∫¶ÁªÑ‰ª∂ ===== */
        .study-progress-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .progress-card {
            background: white;
            border-radius: var(--border-radius-sm);
            padding: 15px;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .progress-card:hover {
            transform: translateY(-3px);
            border-color: var(--primary);
        }

        .progress-card-title {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .progress-card-count {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .progress-card-subtitle {
            font-size: 12px;
            color: var(--gray);
        }

        .progress-card-0 { border-left: 4px solid var(--primary); }
        .progress-card-1 { border-left: 4px solid var(--accent); }
        .progress-card-2 { border-left: 4px solid var(--warning); }
        .progress-card-3 { border-left: 4px solid var(--danger); }
        .progress-card-4 { border-left: 4px solid var(--gray); }

        /* ===== Ë°®Ê†ºÊ†∑Âºè ===== */
        .table-container {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            max-height: 400px;
            overflow-y: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: var(--light);
            padding: 16px;
            text-align: left;
            font-weight: 600;
            color: var(--gray);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
        }

        td {
            padding: 16px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        tr:hover {
            background: rgba(79, 106, 245, 0.03);
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-active {
            background: rgba(6, 214, 160, 0.1);
            color: var(--accent);
        }

        .status-pending {
            background: rgba(255, 209, 102, 0.1);
            color: #E6B400;
        }

        /* ===== Ê®°ÊÄÅÊ°Ü ===== */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: var(--shadow-lg);
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 20px;
            color: var(--gray);
            cursor: pointer;
            padding: 5px;
        }

        /* ===== Ë°®ÂçïÁªÑ‰ª∂ ===== */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: var(--border-radius-sm);
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* ===== Â≠¶‰π†Áõ∏ÂÖ≥ÁªÑ‰ª∂ ===== */
        .study-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--light);
            border-radius: var(--border-radius-sm);
        }

        .study-timer {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .save-progress-btn {
            padding: 8px 16px;
            background: rgba(6, 214, 160, 0.1);
            color: var(--accent);
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .save-progress-btn:hover {
            background: rgba(6, 214, 160, 0.2);
        }

        .flashcard-container {
            perspective: 1000px;
            width: 100%;
            max-width: 400px;
            height: 300px;
            margin: 30px auto;
        }

        .flashcard {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            cursor: pointer;
        }

        .flashcard.flipped {
            transform: rotateY(180deg);
        }

        .flashcard-front,
        .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: var(--border-radius);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            background: white;
            box-shadow: var(--shadow-lg);
        }

        .flashcard-front {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .flashcard-back {
            background: white;
            color: var(--dark);
            transform: rotateY(180deg);
        }

        .word {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
        }

        .meaning {
            font-size: 24px;
            color: var(--gray);
            text-align: center;
        }

        .mastery-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .mastery-btn {
            padding: 15px 25px;
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .mastery-btn-mastered {
            background: rgba(6, 214, 160, 0.1);
            color: var(--accent);
        }

        .mastery-btn-fuzzy {
            background: rgba(255, 209, 102, 0.1);
            color: #E6B400;
        }

        .mastery-btn-forgot {
            background: rgba(239, 71, 111, 0.1);
            color: var(--danger);
        }

        .mastery-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .progress-indicator {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 30px 0;
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: var(--primary);
            transform: scale(1.2);
        }

        .progress-dot.completed {
            background: var(--accent);
        }

        /* ===== ÈÄâÊã©È¢òÊ†∑Âºè ===== */
        .quiz-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .quiz-question {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 30px;
            text-align: center;
            color: var(--dark);
        }

        .quiz-options {
            display: grid;
            gap: 15px;
            margin-bottom: 30px;
        }

        .quiz-option {
            padding: 20px;
            border: 2px solid rgba(0, 0, 0, 0.1);
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .quiz-option:hover {
            border-color: var(--primary);
            background: rgba(79, 106, 245, 0.05);
        }

        .quiz-option.correct {
            border-color: var(--accent);
            background: rgba(6, 214, 160, 0.1);
        }

        .quiz-option.wrong {
            border-color: var(--danger);
            background: rgba(239, 71, 111, 0.1);
        }

        .quiz-option-index {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--gray);
        }

        /* ===== Â•ñÂä±ÁâπÊïà ===== */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1001;
            display: none;
        }

        .confetti-container.active {
            display: block;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--accent);
            top: -20px;
        }

        .reward-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1002;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .reward-animation.active {
            opacity: 1;
            pointer-events: all;
        }

        .reward-content {
            background: white;
            border-radius: var(--border-radius);
            padding: 40px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: var(--shadow-lg);
            animation: rewardPopup 0.5s ease;
        }

        @keyframes rewardPopup {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* ===== Âä†ËΩΩÂä®Áîª ===== */
        .loading {
            border: 3px solid rgba(79, 106, 245, 0.1);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ===== ÁΩëÊ†ºÂ∏ÉÂ±Ä ===== */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        /* ===== ÂæΩÁ´†Ê†∑Âºè ===== */
        .badge-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .badge-card {
            text-align: center;
            padding: 20px;
            border-radius: var(--border-radius);
            background: white;
            transition: transform 0.3s ease;
        }

        .badge-card:hover {
            transform: translateY(-5px);
        }

        .badge-card i {
            font-size: 48px;
            margin-bottom: 15px;
            color: var(--secondary);
        }

        .badge-card.locked i {
            color: var(--gray);
            opacity: 0.5;
        }

        /* ===== ÈÄöÁü•Ê†∑Âºè ===== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: var(--border-radius-sm);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1001;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .notification-success {
            background: rgba(6, 214, 160, 0.1);
            color: var(--accent);
        }

        .notification-warning {
            background: rgba(255, 209, 102, 0.1);
            color: #E6B400;
        }

        .notification-info {
            background: rgba(79, 106, 245, 0.1);
            color: var(--primary);
        }

        .notification-close {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            margin-left: auto;
        }

        /* ===== ËÆ≠ÁªÉÊ®°ÂºèÈÄâÊã© ===== */
        .training-modes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .training-mode-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 30px;
            text-align: center;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .training-mode-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: var(--shadow-lg);
        }

        .training-mode-icon {
            font-size: 48px;
            margin-bottom: 20px;
            color: var(--primary);
        }

        .training-mode-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .training-mode-desc {
            color: var(--gray);
            font-size: 14px;
            margin-bottom: 20px;
        }

        /* ===== ÂìçÂ∫îÂºèËÆæËÆ° ===== */
        @media (max-width: 1024px) {
            .leaderboard-floating {
                position: relative;
                top: auto;
                right: auto;
                width: 100%;
                margin-bottom: 20px;
            }
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
            }
            
            .nav-menu {
                display: flex;
                overflow-x: auto;
                padding: 10px 0;
            }
            
            .nav-item {
                flex: 0 0 auto;
                padding: 10px 15px;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
            
            .flashcard-container {
                height: 250px;
            }
            
            .word {
                font-size: 36px;
            }
            
            .training-modes {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .mastery-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .mastery-btn {
                width: 100%;
                justify-content: center;
            }
            
            .study-progress-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body data-role="student">
    <!-- È°∂ÈÉ®ÊµÆÂä®Ê¶úÂçï -->
    <div class="leaderboard-floating" id="leaderboard">
        <div class="leaderboard-header">
            <div>
                <div>üèÜ ‰ªäÊó•Ê¶úÂçï</div>
                <div class="leaderboard-type" id="leaderboardType">ÊúÄÊó©ÂÆåÊàêÊ¶ú</div>
            </div>
            <button class="leaderboard-refresh" onclick="app.refreshLeaderboard()">
                <i class="fas fa-redo"></i>
            </button>
        </div>
        <div class="leaderboard-content" id="leaderboardContent">
            <!-- Ê¶úÂçïÂÜÖÂÆπÁî±JSÂä®ÊÄÅÁîüÊàê -->
        </div>
    </div>

    <div class="container">
        <!-- ‰æßËæπÊ†è -->
        <div class="sidebar">
            <div class="user-info">
                <div class="avatar">
                    <i class="fas fa-user-graduate"></i>
                </div>
                <div class="user-name" id="userName">Â≠¶Áîü</div>
                <div class="user-role">Â≠¶Áîü</div>
            </div>
            
            <nav class="nav-menu">
                <a class="nav-item active" data-page="dashboard">
                    <i class="fas fa-home"></i>
                    <span>ÊàëÁöÑÂÆáÂÆô</span>
                </a>
                <a class="nav-item" data-page="study">
                    <i class="fas fa-book-open"></i>
                    <span>ÂºÄÂßãÂ≠¶‰π†</span>
                </a>
                <a class="nav-item" data-page="progress">
                    <i class="fas fa-chart-line"></i>
                    <span>Â≠¶‰π†ËøõÂ∫¶</span>
                </a>
                <a class="nav-item" data-page="vocabulary">
                    <i class="fas fa-book"></i>
                    <span>ÂçïËØçÊú¨</span>
                </a>
                <a class="nav-item" data-page="achievements">
                    <i class="fas fa-trophy"></i>
                    <span>ÊàêÂ∞±ÂæΩÁ´†</span>
                </a>
                <a class="nav-item" data-page="settings">
                    <i class="fas fa-cog"></i>
                    <span>ËÆæÁΩÆ</span>
                </a>
            </nav>
            
            <button class="btn logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                <span>ÈÄÄÂá∫ÁôªÂΩï</span>
            </button>
        </div>

        <!-- ‰∏ªÂÜÖÂÆπÂå∫ -->
        <div class="main-content">
            <div id="pageContent">
                <!-- È°µÈù¢ÂÜÖÂÆπ‰ºöÂä®ÊÄÅÂä†ËΩΩ -->
            </div>
        </div>
    </div>

    <!-- Â•ñÂä±ÁâπÊïà -->
    <div class="confetti-container" id="confettiContainer"></div>
    <div class="reward-animation" id="rewardAnimation">
        <div class="reward-content" id="rewardContent"></div>
    </div>

    <!-- Ê®°ÊÄÅÊ°Ü -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <button class="modal-close" id="modalClose">
                <i class="fas fa-times"></i>
            </button>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // ÈÖçÁΩÆÂ∏∏Èáè
        const SUPABASE_CONFIG = {
            url: 'https://your-supabase-url.supabase.co',
            key: 'your-anon-key'
        };

        // Ëã±ÊñáÂêçÂ≠óÂ∫ìÔºàÁî®‰∫éÁîüÊàêÊ¶úÂçïËôöÊûÑÊï∞ÊçÆÔºâ
        const ENGLISH_NAMES = [
            'Elaine', 'Abel', 'Aaron', 'Bahadur', 'Bahar', 'Gabin', 'Gable',
            'Bahari', 'Gabriel', 'Bahia', 'Faber', 'Fabiana', 'Bahira',
            'Bahram', 'Bahula', 'Camelia', 'Calantha', 'Calanthe', 'Hannes',
            'Hannibal', 'Halston', 'Haluk', 'Malaki', 'Malcolm', 'Daley',
            'Daleyza', 'Kai', 'Leo', 'Liam', 'Noah', 'Oliver', 'Elijah',
            'James', 'William', 'Benjamin', 'Lucas', 'Henry', 'Alexander'
        ];

        // ÂçïËØçËÆ∞ÂøÜÁÆóÊ≥ïÁ±ª
        class WordMemoryAlgorithm {
            static calculateDifficulty(word) {
                const length = word.english.length;
                const commonWords = ['the', 'be', 'to', 'of', 'and', 'a', 'in', 'that', 'have', 'i'];
                const isCommon = commonWords.includes(word.english.toLowerCase());
                
                let difficulty = 1;
                if (length <= 4) difficulty = 1;
                else if (length <= 6) difficulty = 2;
                else if (length <= 8) difficulty = 3;
                else if (length <= 10) difficulty = 4;
                else difficulty = 5;
                
                if (isCommon) difficulty = Math.max(1, difficulty - 1);
                return difficulty;
            }
            
            static getReviewPriority(word) {
                const now = new Date();
                const lastReviewed = word.lastReviewed ? new Date(word.lastReviewed) : new Date(0);
                const daysSinceReview = Math.floor((now - lastReviewed) / (1000 * 60 * 60 * 24));
                
                let priority = 100 - word.mastery;
                const timeFactor = 1 + (daysSinceReview * 0.15);
                priority *= timeFactor;
                
                if (word.reviewCount > 0) {
                    const errorRate = (word.reviewCount - word.correctCount) / word.reviewCount;
                    priority *= (1 + errorRate * 2);
                }
                
                return priority;
            }
        }

        // Ê¶úÂçïËÆ°ÁÆóÁ±ª
        class LeaderboardCalculator {
            // A. ÊØèÊó•ÊúÄÊó©ÂÆåÊàêÊ¶ú
            static calculateEarliestCompletionScore(completionTime) {
                const [hour, minute] = completionTime.split(':').map(Number);
                const baseScore = 100;
                const timeBonus = (24 - hour) * 5;
                const minuteBonus = (60 - minute) * 0.1;
                return baseScore + timeBonus + minuteBonus;
            }

            // B. ÂçïËØçÊéåÊè°Â§ßÂ∏àÊ¶ú
            static calculateMasteryScore(studentData) {
                const masteredWords = studentData.masteredWords || 0;
                const totalProficiency = studentData.totalProficiency || 0;
                const streakDays = studentData.streakDays || 0;
                const accuracy = studentData.accuracy || 0;

                const baseScore = masteredWords * 1;
                const proficiencyBonus = totalProficiency * 0.01;
                const streakBonus = streakDays * 2;
                const accuracyBonus = accuracy * 10;
                
                return baseScore + proficiencyBonus + streakBonus + accuracyBonus;
            }
        }

        class StudentApp {
            constructor() {
                this.currentPage = 'dashboard';
                this.supabase = null;
                this.user = {
                    id: localStorage.getItem('userId') || `S${Date.now().toString().slice(-6)}`,
                    name: localStorage.getItem('userName') || 'Â≠¶Áîü',
                    level: parseInt(localStorage.getItem('userLevel')) || 1,
                    exp: parseInt(localStorage.getItem('userExp')) || 0,
                    streakDays: parseInt(localStorage.getItem('streakDays')) || 0,
                    todayCompleted: localStorage.getItem('todayCompleted') === 'true' || false,
                    groups: JSON.parse(localStorage.getItem('userGroups')) || [],
                    lastStudyDate: localStorage.getItem('lastStudyDate') || null,
                    completionTime: localStorage.getItem('completionTime') || null
                };
                
                // Â≠¶‰π†Áä∂ÊÄÅ
                this.studyState = JSON.parse(localStorage.getItem('studyState')) || {
                    dailyCompleted: false,
                    sessionStartTime: null,
                    totalStudyTime: 0,
                    todayWords: {
                        new: 0,
                        mastered: 0,
                        fuzzy: 0,
                        forgot: 0,
                        unlearned: 0
                    },
                    currentSession: null
                };
                
                // Â≠¶‰π†ÈÖçÁΩÆ
                this.config = JSON.parse(localStorage.getItem('studyConfig')) || {
                    dailyNewWords: 10,
                    dailyReviewWords: { min: 10, max: 20 },
                    maxStudyTime: 15,
                    autoSaveInterval: 30
                };
                
                // ÂçïËØçÊï∞ÊçÆ
                this.vocabulary = JSON.parse(localStorage.getItem('vocabulary')) || [];
                this.wordPools = {
                    new: [],
                    review: [],
                    mastered: [],
                    fuzzy: [],
                    forgot: []
                };
                
                // ÊàêÂ∞±Êï∞ÊçÆ
                this.achievements = JSON.parse(localStorage.getItem('achievements')) || [];
                this.praises = JSON.parse(localStorage.getItem('praises')) || [];
                
                // ÂêåÊ≠•Áä∂ÊÄÅ
                this.lastSyncTime = localStorage.getItem('lastSyncTime');
                this.autoSaveTimer = null;
                this.syncInterval = null;
                
                // Ê¶úÂçïÁ±ªÂûã (ÊØèÊó•ËΩÆÊç¢)
                this.currentLeaderboardType = this.getDailyLeaderboardType();
                
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.loadUserInfo();
                this.checkDailyReset();
                this.loadPage('dashboard');
                this.startAutoSave();
                this.startSyncInterval();
                this.loadLeaderboard();
                
                // Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ
                if (!localStorage.getItem('userRole') || localStorage.getItem('userRole') !== 'student') {
                    window.location.href = 'index.html';
                }
            }
            
            setupEventListeners() {
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        const page = item.dataset.page;
                        this.loadPage(page);
                        document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                        item.classList.add('active');
                    });
                });
                
                document.getElementById('logoutBtn').addEventListener('click', () => {
                    if (confirm('Á°ÆËÆ§ÈÄÄÂá∫ÁôªÂΩïÂêóÔºüÈÄÄÂá∫ÂêéÂ∞ÜËøîÂõûÁôªÂΩïÈ°µÈù¢„ÄÇ')) {
                        localStorage.clear();
                        window.location.href = 'index.html';
                    }
                });
                
                document.getElementById('modalClose').addEventListener('click', () => {
                    this.closeModal();
                });
                
                document.getElementById('modal').addEventListener('click', (e) => {
                    if (e.target.id === 'modal') {
                        this.closeModal();
                    }
                });
                
                document.getElementById('rewardAnimation').addEventListener('click', (e) => {
                    if (e.target.id === 'rewardAnimation') {
                        this.closeRewardAnimation();
                    }
                });
            }
            
            loadUserInfo() {
                document.getElementById('userName').textContent = this.user.name;
            }
            
            // Ê£ÄÊü•ÊØèÊó•ÈáçÁΩÆ
            checkDailyReset() {
                const today = new Date().toDateString();
                
                if (this.user.lastStudyDate !== today) {
                    this.studyState = {
                        dailyCompleted: false,
                        sessionStartTime: null,
                        totalStudyTime: 0,
                        todayWords: {
                            new: 0,
                            mastered: 0,
                            fuzzy: 0,
                            forgot: 0,
                            unlearned: this.getUnlearnedWordsCount()
                        },
                        currentSession: null
                    };
                    
                    this.user.lastStudyDate = today;
                    this.user.completionTime = null;
                    this.saveData();
                    this.syncToTeacher();
                }
            }
            
            getUnlearnedWordsCount() {
                return this.vocabulary.filter(word => word.status === 'new' || word.mastery < 30).length;
            }
            
            // Ëé∑ÂèñÊØèÊó•Ê¶úÂçïÁ±ªÂûãÔºàÊ®°ÊãüËΩÆÊç¢Ôºâ
            getDailyLeaderboardType() {
                const types = ['earliest', 'mastery'];
                const today = new Date().getDate();
                return types[today % 2];
            }
            
            // ÂºÄÂßãËá™Âä®ÂêåÊ≠•ÂÆöÊó∂Âô®
            startSyncInterval() {
                this.syncInterval = setInterval(() => {
                    this.syncToTeacher();
                }, 5 * 60 * 1000); // ÊØè5ÂàÜÈíüÂêåÊ≠•‰∏ÄÊ¨°
            }
            
            // ÂêåÊ≠•Ëß¶ÂèëÂô®
            triggerSync(action, data = {}) {
                const syncData = {
                    student_id: this.user.id,
                    name: this.user.name,
                    timestamp: new Date().toISOString(),
                    action: action,
                    data: {
                        daily_completed: this.studyState.dailyCompleted,
                        completion_time: this.user.completionTime,
                        today_stats: this.studyState.todayWords,
                        vocabulary_updates: this.vocabulary,
                        streak_days: this.user.streakDays
                    }
                };
                
                console.log('ÂêåÊ≠•Êï∞ÊçÆ:', syncData);
                this.syncToTeacher();
                
                // ÂÆûÊó∂Êõ¥Êñ∞Ê¶úÂçï
                setTimeout(() => this.loadLeaderboard(), 1000);
            }
            
            // ÂêåÊ≠•Âà∞ÊïôÂ∏àÁ´Ø
            async syncToTeacher() {
                try {
                    const syncData = {
                        userId: this.user.id,
                        studentName: this.user.name,
                        syncTime: new Date().toISOString(),
                        studyData: {
                            todayCompleted: this.studyState.dailyCompleted,
                            todayStats: this.studyState.todayWords,
                            currentStreak: this.user.streakDays,
                            totalWords: this.vocabulary.length,
                            masteredWords: this.vocabulary.filter(w => w.mastery >= 70).length,
                            fuzzyWords: this.vocabulary.filter(w => w.mastery >= 30 && w.mastery < 70).length,
                            forgotWords: this.vocabulary.filter(w => w.mastery < 30 && w.mastery > 0).length,
                            completionTime: this.user.completionTime
                        },
                        vocabulary: this.vocabulary.map(word => ({
                            english: word.english,
                            chinese: word.chinese,
                            mastery: word.mastery,
                            lastReviewed: word.lastReviewed,
                            reviewCount: word.reviewCount,
                            correctCount: word.correctCount
                        }))
                    };
                    
                    console.log('ÂêåÊ≠•Âà∞ÊïôÂ∏àÁ´Ø:', syncData);
                    
                    // Ê®°ÊãüSupabaseÂêåÊ≠•
                    // this.supabase.from('student_progress').upsert(syncData);
                    
                    this.lastSyncTime = new Date().toISOString();
                    localStorage.setItem('lastSyncTime', this.lastSyncTime);
                    
                    // ‰ªéÊïôÂ∏àÁ´ØËé∑ÂèñÊñ∞ÂçïËØç
                    await this.fetchTeacherWords();
                    
                } catch (error) {
                    console.error('ÂêåÊ≠•Â§±Ë¥•:', error);
                }
            }
            
            // ‰ªéÊïôÂ∏àÁ´ØËé∑ÂèñÂçïËØç
            async fetchTeacherWords() {
                try {
                    // Ê®°Êãü‰ªéÊïôÂ∏àÁ´ØËé∑ÂèñÊï∞ÊçÆ
                    const mockTeacherWords = [
                        { id: 101, english: 'education', chinese: 'ÊïôËÇ≤', group: 'Ê†∏ÂøÉËØçÊ±á800', difficulty: 4 },
                        { id: 102, english: 'technology', chinese: 'ÊäÄÊúØ', group: 'Ê†∏ÂøÉËØçÊ±á800', difficulty: 4 },
                        { id: 103, english: 'environment', chinese: 'ÁéØÂ¢É', group: 'Ê†∏ÂøÉËØçÊ±á800', difficulty: 5 },
                        { id: 104, english: 'communication', chinese: '‰∫§ÊµÅ', group: 'Ê†∏ÂøÉËØçÊ±á800', difficulty: 5 },
                        { id: 105, english: 'opportunity', chinese: 'Êú∫‰ºö', group: 'Ê†∏ÂøÉËØçÊ±á800', difficulty: 4 }
                    ];
                    
                    // Ê∑ªÂä†Âà∞Êú¨Âú∞ËØçÂ∫ì
                    mockTeacherWords.forEach(word => {
                        if (!this.vocabulary.find(w => w.english === word.english)) {
                            this.vocabulary.push({
                                ...word,
                                mastery: 50,
                                lastReviewed: null,
                                reviewCount: 0,
                                correctCount: 0,
                                status: 'new'
                            });
                        }
                    });
                    
                    this.saveData();
                    this.showNotification('‰ªéÊïôÂ∏àÁ´ØÂêåÊ≠•‰∫Ü5‰∏™Êñ∞ÂçïËØç', 'info');
                    
                } catch (error) {
                    console.error('Ëé∑ÂèñÊïôÂ∏àÂçïËØçÂ§±Ë¥•:', error);
                }
            }
            
            // Ëé∑Âèñ‰ªäÊó•Â≠¶‰π†ÁªüËÆ°
            getTodayStats() {
                const totalNewWords = this.config.dailyNewWords;
                const learnedToday = this.studyState.todayWords.new;
                const progressPercent = Math.min((learnedToday / totalNewWords) * 100, 100);
                
                return {
                    totalNewWords,
                    learnedToday,
                    progressPercent,
                    mastered: this.studyState.todayWords.mastered,
                    fuzzy: this.studyState.todayWords.fuzzy,
                    forgot: this.studyState.todayWords.forgot,
                    unlearned: this.studyState.todayWords.unlearned
                };
            }
            
            async loadPage(page) {
                this.currentPage = page;
                const container = document.getElementById('pageContent');
                
                switch(page) {
                    case 'dashboard':
                        container.innerHTML = this.renderDashboard();
                        this.setupDashboardEvents();
                        break;
                    case 'study':
                        container.innerHTML = this.renderStudyPage();
                        this.setupStudyEvents();
                        break;
                    case 'progress':
                        container.innerHTML = this.renderProgressPage();
                        this.setupProgressEvents();
                        break;
                    case 'vocabulary':
                        container.innerHTML = this.renderVocabulary();
                        this.setupVocabularyEvents();
                        break;
                    case 'achievements':
                        container.innerHTML = this.renderAchievements();
                        this.setupAchievementEvents();
                        break;
                    case 'settings':
                        container.innerHTML = this.renderSettings();
                        this.setupSettingsEvents();
                        break;
                    default:
                        container.innerHTML = this.renderDashboard();
                        this.setupDashboardEvents();
                }
            }
            
            renderDashboard() {
                const stats = this.getTodayStats();
                const expNeeded = this.user.level * 100 + 50;
                const expPercent = Math.min((this.user.exp / expNeeded) * 100, 100);
                
                return `
                    <h1 class="page-title">ÊàëÁöÑÂ≠¶‰π†ÂÆáÂÆô</h1>
                    <p class="page-subtitle">‰Ω†Â•ΩÔºå${this.user.name}ÔºÅ‰ªäÂ§©‰πüË¶ÅÂä†Ê≤πÂì¶ÔºÅ</p>
                    
                    ${this.studyState.dailyCompleted ? `
                        <div class="card" style="background: linear-gradient(135deg, var(--accent) 0%, #05C492 100%); color: white; margin-bottom: 25px;">
                            <div class="card-header">
                                <h3 class="card-title" style="color: white;">üéâ ‰ªäÊó•ÊâìÂç°Â∑≤ÂÆåÊàê</h3>
                                <i class="fas fa-check-circle" style="font-size: 24px;"></i>
                            </div>
                            <p style="margin: 15px 0; opacity: 0.9;">ÂÆåÊàêÊó∂Èó¥: ${this.user.completionTime || '‰ªäÊó•'}</p>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <button class="btn btn-warning" id="extraTrainingBtn">
                                    <i class="fas fa-plus-circle"></i>
                                    <span>‚ûï Âä†Â≠¶Êñ∞ËØç</span>
                                </button>
                                <button class="btn btn-secondary" id="reviewWeakBtn">
                                    <i class="fas fa-redo"></i>
                                    <span>üîÅ Â§ç‰π†Âº±È°π</span>
                                </button>
                            </div>
                        </div>
                    ` : `
                        <div class="card" style="background: linear-gradient(135deg, var(--primary) 0%, #6C83F7 100%); color: white; margin-bottom: 25px;">
                            <div class="card-header">
                                <h3 class="card-title" style="color: white;">üî• ‰ªäÊó•ÊâìÂç°‰ªªÂä°</h3>
                                <i class="fas fa-rocket" style="font-size: 24px;"></i>
                            </div>
                            <div style="margin: 15px 0;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                    <span style="opacity: 0.9;">Êñ∞ËØçÂ≠¶‰π†</span>
                                    <span style="font-weight: 600;">${stats.learnedToday}/${stats.totalNewWords}</span>
                                </div>
                                <div class="progress-bar" style="margin-bottom: 15px;">
                                    <div class="progress-fill" style="width: ${stats.progressPercent}%"></div>
                                </div>
                            </div>
                            <button class="btn btn-success" id="dailyCheckInBtn" style="width: auto; padding: 15px 30px; font-size: 18px;">
                                <i class="fas fa-play-circle"></i>
                                <span>üöÄ ÂºÄÂßãÊâìÂç°</span>
                            </button>
                            <p style="margin-top: 10px; opacity: 0.8; font-size: 14px;">È¢ÑËÆ°${this.config.maxStudyTime}ÂàÜÈíü ¬∑ Êô∫ËÉΩÁÆóÊ≥ï</p>
                        </div>
                    `}
                    
                    <div class="grid">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">üåü ÊàëÁöÑÁ≠âÁ∫ß</h3>
                                <div class="card-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                            </div>
                            <div style="text-align: center; margin: 20px 0;">
                                <div style="font-size: 48px; font-weight: 700; color: var(--primary);">Lv.${this.user.level}</div>
                                <div style="color: var(--gray); margin: 10px 0;">ÂçïËØçÊé¢Á¥¢ËÄÖ</div>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${expPercent}%"></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                                <span style="color: var(--gray);">EXP: ${this.user.exp}/${expNeeded}</span>
                                <span style="color: var(--accent); font-weight: 600;">${Math.round(expPercent)}%</span>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">‚ö° Â≠¶‰π†ËÉΩÈáè</h3>
                                <div class="card-icon">
                                    <i class="fas fa-bolt"></i>
                                </div>
                            </div>
                            <div style="text-align: center; margin: 30px 0;">
                                <div style="width: 100px; height: 100px; border: 10px solid var(--accent); border-radius: 50%; display: inline-flex; align-items: center; justify-content: center;">
                                    <div style="font-size: 24px; font-weight: 700;">${this.user.streakDays}</div>
                                </div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 24px; font-weight: 700; color: var(--dark); margin-bottom: 5px;">
                                    ${this.user.streakDays}Â§©
                                </div>
                                <div style="color: var(--gray);">ËøûÁª≠Â≠¶‰π†</div>
                            </div>
                        </div>
                    </div>
                    
                    ${this.praises.length > 0 ? `
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">üéâ ÊïôÂ∏àË°®Êâ¨</h3>
                                <div class="card-icon">
                                    <i class="fas fa-award"></i>
                                </div>
                            </div>
                            <div style="margin-top: 20px;">
                                ${this.praises.slice(0, 3).map(praise => `
                                    <div style="padding: 15px; background: ${praise.read ? 'rgba(0,0,0,0.02)' : 'rgba(6, 214, 160, 0.1)'}; border-radius: 10px; margin-bottom: 10px; border-left: 4px solid ${praise.read ? 'var(--gray)' : 'var(--accent)'};">
                                        <div style="font-weight: 600; color: var(--accent); margin-bottom: 5px;">
                                            ${praise.teacher} ¬∑ ${praise.type}
                                        </div>
                                        <div>${praise.message}</div>
                                        <div style="font-size: 12px; color: var(--gray); margin-top: 5px;">
                                            ${new Date(praise.time).toLocaleString()}
                                            ${!praise.read ? '<span style="color: var(--primary); margin-left: 10px;">‚óè Êñ∞</span>' : ''}
                                        </div>
                                    </div>
                                `).join('')}
                                ${this.praises.length > 3 ? `
                                    <button class="action-btn" onclick="app.loadPage('achievements')" style="width: 100%; margin-top: 10px;">
                                        Êü•ÁúãÂÖ®ÈÉ®Ë°®Êâ¨ (${this.praises.length})
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    ` : ''}
                    
                    <div class="training-modes">
                        <div class="training-mode-card" onclick="app.startTraining('new', 10)">
                            <div class="training-mode-icon">
                                <i class="fas fa-book"></i>
                            </div>
                            <div class="training-mode-title">Ëá™Áî±Â≠¶‰π†</div>
                            <div class="training-mode-desc">
                                10‰∏™Êñ∞ËØç + Êô∫ËÉΩÂ§ç‰π†
                            </div>
                            <button class="action-btn">ÂºÄÂßãÂ≠¶‰π†</button>
                        </div>
                        
                        <div class="training-mode-card" onclick="app.startTraining('weak', 0)">
                            <div class="training-mode-icon">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <div class="training-mode-title">Â§ç‰π†Âº±È°π</div>
                            <div class="training-mode-desc">
                                ÈáçÁÇπÊîªÂÖã‰ΩéÂàÜËØç
                            </div>
                            <button class="action-btn">ÂºÄÂßãÂ§ç‰π†</button>
                        </div>
                        
                        <div class="training-mode-card" onclick="app.startTraining('all', 0)">
                            <div class="training-mode-icon">
                                <i class="fas fa-brain"></i>
                            </div>
                            <div class="training-mode-title">ÁªºÂêàËÆ≠ÁªÉ</div>
                            <div class="training-mode-desc">
                                ÂÖ®Èù¢ÊèêÂçáÁÜüÁªÉÂ∫¶
                            </div>
                            <button class="action-btn">ÂºÄÂßãËÆ≠ÁªÉ</button>
                        </div>
                    </div>
                `;
            }
            
            setupDashboardEvents() {
                const dailyCheckInBtn = document.getElementById('dailyCheckInBtn');
                if (dailyCheckInBtn) {
                    dailyCheckInBtn.addEventListener('click', () => {
                        this.startDailyCheckIn();
                    });
                }
                
                const extraTrainingBtn = document.getElementById('extraTrainingBtn');
                if (extraTrainingBtn) {
                    extraTrainingBtn.addEventListener('click', () => {
                        this.startTraining('extra', 10);
                    });
                }
                
                const reviewWeakBtn = document.getElementById('reviewWeakBtn');
                if (reviewWeakBtn) {
                    reviewWeakBtn.addEventListener('click', () => {
                        this.startTraining('weak', 0);
                    });
                }
            }
            
            renderStudyPage() {
                return `
                    <div style="display: flex; align-items: center; margin-bottom: 30px;">
                        <button class="action-btn" onclick="app.loadPage('dashboard')" style="margin-right: 15px;">
                            <i class="fas fa-arrow-left"></i> ËøîÂõû
                        </button>
                        <h1 class="page-title">ÂºÄÂßãÂ≠¶‰π†</h1>
                    </div>
                    
                    <div id="studyContent">
                        <div class="card" style="text-align: center; padding: 40px;">
                            <div class="loading" style="width: 40px; height: 40px; border-width: 4px; margin: 20px auto;"></div>
                            <h3 style="margin: 20px 0;">‚ö° ÂáÜÂ§áÂ≠¶‰π†ÂÜÖÂÆπ</h3>
                            <div class="progress-bar" style="margin: 20px auto; width: 80%;">
                                <div class="progress-fill" style="width: 80%;"></div>
                            </div>
                            <div style="margin: 20px 0;">
                                <div style="margin-bottom: 10px;">
                                    <i class="fas fa-book" style="color: var(--primary); margin-right: 10px;"></i>
                                    <span>Êô∫ËÉΩÁÆóÊ≥ïÂåπÈÖç‰∏≠...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            setupStudyEvents() {
                if (this.studyState.currentSession) {
                    this.restoreSession();
                }
            }
            
            // ÂºÄÂßãÊØèÊó•ÊâìÂç°
            startDailyCheckIn() {
                if (this.studyState.dailyCompleted) {
                    this.showNotification('‰ªäÊó•ÊâìÂç°Â∑≤ÂÆåÊàêÔºåÂèØ‰ª•ÈÄâÊã©Âä†Â≠¶Êñ∞ËØç', 'info');
                    return;
                }
                
                this.studyState.currentSession = {
                    type: 'daily',
                    startTime: new Date().toISOString(),
                    elapsedTime: 0,
                    maxTime: this.config.maxStudyTime * 60,
                    currentPhase: 'flashcard',
                    currentBatch: 1,
                    totalBatches: 1,
                    words: this.prepareDailyCheckInWords(),
                    currentWordIndex: 0,
                    flashcardResults: {},
                    quizResults: {},
                    completed: false
                };
                
                this.studyState.sessionStartTime = new Date().toISOString();
                this.saveData();
                this.triggerSync('start_daily_checkin');
                this.startFlashcardPhase();
            }
            
            prepareDailyCheckInWords() {
                const newWords = this.vocabulary
                    .filter(word => word.mastery === 0)
                    .slice(0, this.config.dailyNewWords);
                
                const reviewWords = this.getReviewWords(this.config.dailyReviewWords.min, this.config.dailyReviewWords.max);
                const allWords = [...reviewWords, ...newWords];
                
                allWords.sort((a, b) => {
                    if (a.mastery < 30 && b.mastery >= 30) return -1;
                    if (a.mastery >= 30 && b.mastery < 30) return 1;
                    if (a.mastery < 70 && b.mastery >= 70) return -1;
                    if (a.mastery >= 70 && b.mastery < 70) return 1;
                    return 0;
                });
                
                return allWords.map(word => ({
                    ...word,
                    flashcardAppearances: 0,
                    maxFlashcards: this.getMaxFlashcards(word.mastery),
                    quizAppearances: 0,
                    status: 'pending'
                }));
            }
            
            getReviewWords(min, max) {
                const wordsToReview = this.vocabulary
                    .filter(word => word.mastery > 0)
                    .map(word => ({
                        ...word,
                        priority: WordMemoryAlgorithm.getReviewPriority(word)
                    }))
                    .sort((a, b) => b.priority - a.priority)
                    .slice(0, max);
                
                if (wordsToReview.length < min) {
                    const masteredWords = this.vocabulary
                        .filter(word => word.mastery >= 70)
                        .sort(() => Math.random() - 0.5)
                        .slice(0, min - wordsToReview.length);
                    
                    return [...wordsToReview, ...masteredWords];
                }
                
                return wordsToReview;
            }
            
            getMaxFlashcards(mastery) {
                if (mastery >= 70) return 0;
                if (mastery >= 30) return 2;
                return 5;
            }
            
            // Èó™Âç°Èò∂ÊÆµ
            startFlashcardPhase() {
                const session = this.studyState.currentSession;
                if (!session || session.words.length === 0) {
                    this.showNotification('Ê≤°ÊúâÈúÄË¶ÅÂ≠¶‰π†ÁöÑÂçïËØç', 'info');
                    return;
                }
                
                this.loadPage('study');
                
                setTimeout(() => {
                    this.renderFlashcard();
                }, 500);
            }
            
            renderFlashcard() {
                const session = this.studyState.currentSession;
                if (!session) return;
                
                const studyContent = document.getElementById('studyContent');
                if (!studyContent) return;
                
                const now = new Date();
                const startTime = new Date(session.startTime);
                const elapsedSeconds = Math.floor((now - startTime) / 1000) + session.elapsedTime;
                
                if (elapsedSeconds >= session.maxTime) {
                    this.handleTimeUp();
                    return;
                }
                
                const remainingTime = Math.max(0, session.maxTime - elapsedSeconds);
                const minutes = Math.floor(remainingTime / 60);
                const seconds = remainingTime % 60;
                
                let currentWord = null;
                let wordIndex = -1;
                
                for (let i = 0; i < session.words.length; i++) {
                    const word = session.words[i];
                    if (word.flashcardAppearances < word.maxFlashcards && word.status === 'pending') {
                        currentWord = word;
                        wordIndex = i;
                        break;
                    }
                }
                
                if (!currentWord) {
                    this.startQuizPhase();
                    return;
                }
                
                session.currentWordIndex = wordIndex;
                
                studyContent.innerHTML = `
                    <div class="study-controls">
                        <div class="study-timer">
                            <i class="fas fa-clock"></i>
                            Ââ©‰ΩôÊó∂Èó¥Ôºö${minutes}:${seconds.toString().padStart(2, '0')}
                        </div>
                        <button class="save-progress-btn" onclick="app.saveStudyProgress()">
                            <i class="fas fa-save"></i>
                            ‰øùÂ≠òËøõÂ∫¶
                        </button>
                    </div>
                    
                    <div class="card" style="text-align: center;">
                        <div style="margin-bottom: 20px; font-size: 14px; color: var(--gray);">
                            <i class="fas fa-layer-group"></i>
                            Èó™Âç°Èò∂ÊÆµ ¬∑ ÊâπÊ¨° ${session.currentBatch}/${session.totalBatches}
                        </div>
                        
                        <div class="flashcard-container">
                            <div class="flashcard" id="flashcard">
                                <div class="flashcard-front">
                                    <div class="word">${currentWord.english}</div>
                                    <div style="margin-top: 20px; opacity: 0.8; font-size: 14px;">
                                        <i class="fas fa-hand-pointer"></i> ÁÇπÂáªÂç°ÁâáÊü•ÁúãÈáä‰πâ
                                    </div>
                                </div>
                                <div class="flashcard-back">
                                    <div class="word" style="color: var(--primary);">${currentWord.english}</div>
                                    <div class="meaning">${currentWord.chinese}</div>
                                    ${currentWord.group ? `
                                        <div style="margin-top: 15px; font-size: 14px; color: var(--gray);">
                                            ÂàÜÁªÑÔºö${currentWord.group}
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        </div>
                        
                        <div class="progress-indicator">
                            ${session.words.map((word, index) => {
                                let status = '';
                                if (word.status === 'mastered') status = 'completed';
                                else if (word.status === 'fuzzy') status = 'completed';
                                else if (word.status === 'forgot') status = 'completed';
                                else if (index === wordIndex) status = 'active';
                                
                                return `<div class="progress-dot ${status}"></div>`;
                            }).join('')}
                        </div>
                        
                        <div class="mastery-buttons" id="masteryButtons" style="display: none;">
                            <button class="mastery-btn mastery-btn-mastered" data-mastery="mastered">
                                <i class="fas fa-check-circle"></i>
                                ‚úÖ Â∑≤ÊéåÊè°
                            </button>
                            <button class="mastery-btn mastery-btn-fuzzy" data-mastery="fuzzy">
                                <i class="fas fa-question-circle"></i>
                                ‚ö†Ô∏è Ê®°Á≥ä
                            </button>
                            <button class="mastery-btn mastery-btn-forgot" data-mastery="forgot">
                                <i class="fas fa-times-circle"></i>
                                ‚ùå Ê≤°Âç∞Ë±°
                            </button>
                        </div>
                        
                        <div style="margin-top: 20px; font-size: 14px; color: var(--gray);">
                            ËøõÂ∫¶Ôºö${session.words.filter(w => w.status !== 'pending').length}/${session.words.length}
                        </div>
                    </div>
                `;
                
                const flashcard = document.getElementById('flashcard');
                const masteryButtons = document.getElementById('masteryButtons');
                
                flashcard.addEventListener('click', () => {
                    flashcard.classList.toggle('flipped');
                    masteryButtons.style.display = 'flex';
                });
                
                document.querySelectorAll('.mastery-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const mastery = e.target.closest('button').dataset.mastery;
                        this.handleFlashcardResponse(currentWord, mastery);
                    });
                });
                
                this.autoSaveProgress();
            }
            
            handleFlashcardResponse(word, mastery) {
                const session = this.studyState.currentSession;
                if (!session) return;
                
                word.flashcardAppearances++;
                word.status = mastery;
                session.flashcardResults[word.id || word.english] = mastery;
                
                if (word.mastery === 0) {
                    this.studyState.todayWords.new++;
                }
                
                switch(mastery) {
                    case 'mastered':
                        this.studyState.todayWords.mastered++;
                        word.mastery = 85;
                        break;
                    case 'fuzzy':
                        this.studyState.todayWords.fuzzy++;
                        word.mastery = 50;
                        break;
                    case 'forgot':
                        this.studyState.todayWords.forgot++;
                        word.mastery = 15;
                        break;
                }
                
                const originalWord = this.vocabulary.find(w => 
                    (w.id && w.id === word.id) || w.english === word.english
                );
                
                if (originalWord) {
                    originalWord.mastery = word.mastery;
                    originalWord.lastReviewed = new Date().toISOString();
                    originalWord.reviewCount = (originalWord.reviewCount || 0) + 1;
                    
                    if (mastery === 'mastered') {
                        originalWord.correctCount = (originalWord.correctCount || 0) + 1;
                    }
                }
                
                this.saveData();
                this.triggerSync('complete_flashcard', { word: word.english, mastery });
                
                setTimeout(() => {
                    this.renderFlashcard();
                }, 300);
            }
            
            // ÈÄâÊã©È¢òÈò∂ÊÆµ
            startQuizPhase() {
                const session = this.studyState.currentSession;
                if (!session) return;
                
                session.currentPhase = 'quiz';
                const wordsForQuiz = session.words.filter(word => {
                    if (word.status === 'mastered') {
                        return Math.random() < 0.3;
                    }
                    return word.status === 'fuzzy' || word.status === 'forgot';
                });
                
                if (wordsForQuiz.length === 0) {
                    this.completeDailyCheckIn();
                    return;
                }
                
                session.quizWords = wordsForQuiz;
                session.currentQuizIndex = 0;
                session.quizScore = 0;
                
                this.renderQuiz();
            }
            
            renderQuiz() {
                const session = this.studyState.currentSession;
                if (!session || !session.quizWords) return;
                
                if (session.currentQuizIndex >= session.quizWords.length) {
                    const forgotWords = session.words.filter(w => w.status === 'forgot');
                    
                    if (forgotWords.length > 0) {
                        session.quizWords = forgotWords;
                        session.currentQuizIndex = 0;
                        this.renderQuiz();
                        return;
                    }
                    
                    this.completeDailyCheckIn();
                    return;
                }
                
                const currentWord = session.quizWords[session.currentQuizIndex];
                const studyContent = document.getElementById('studyContent');
                
                const now = new Date();
                const startTime = new Date(session.startTime);
                const elapsedSeconds = Math.floor((now - startTime) / 1000) + session.elapsedTime;
                
                if (elapsedSeconds >= session.maxTime) {
                    this.handleTimeUp();
                    return;
                }
                
                const options = this.generateQuizOptions(currentWord);
                
                studyContent.innerHTML = `
                    <div class="study-controls">
                        <div class="study-timer">
                            <i class="fas fa-clock"></i>
                            Ââ©‰ΩôÊó∂Èó¥Ôºö${Math.floor((session.maxTime - elapsedSeconds) / 60)}:${((session.maxTime - elapsedSeconds) % 60).toString().padStart(2, '0')}
                        </div>
                        <div style="font-weight: 600; color: var(--accent);">
                            <i class="fas fa-check-circle"></i>
                            ÂæóÂàÜÔºö${session.quizScore}
                        </div>
                    </div>
                    
                    <div class="quiz-container">
                        <div class="quiz-question">
                            "${currentWord.english}" ÁöÑ‰∏≠ÊñáÊÑèÊÄùÊòØÔºü
                        </div>
                        
                        <div class="quiz-options" id="quizOptions">
                            ${options.map((option, index) => `
                                <div class="quiz-option" data-correct="${option.isCorrect}" data-index="${index}">
                                    <div class="quiz-option-index">
                                        ${String.fromCharCode(65 + index)}
                                    </div>
                                    <div>${option.text}</div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="progress-indicator">
                            ${session.quizWords.map((_, index) => `
                                <div class="progress-dot ${index < session.currentQuizIndex ? 'completed' : ''} ${index === session.currentQuizIndex ? 'active' : ''}"></div>
                            `).join('')}
                        </div>
                        
                        <div style="text-align: center; margin-top: 30px; color: var(--gray); font-size: 14px;">
                            <i class="fas fa-info-circle"></i>
                            ÈÄâÊã©È¢òÈò∂ÊÆµ ¬∑ Á°Æ‰øùÊâÄÊúâÂçïËØçËá≥Â∞ëËææÂà∞Ê®°Á≥äÁä∂ÊÄÅ
                        </div>
                    </div>
                `;
                
                document.querySelectorAll('.quiz-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        const isCorrect = e.target.closest('.quiz-option').dataset.correct === 'true';
                        const allOptions = document.querySelectorAll('.quiz-option');
                        
                        allOptions.forEach(opt => {
                            opt.style.pointerEvents = 'none';
                        });
                        
                        allOptions.forEach(opt => {
                            if (opt.dataset.correct === 'true') {
                                opt.classList.add('correct');
                            } else if (opt === e.target.closest('.quiz-option')) {
                                opt.classList.add('wrong');
                            }
                        });
                        
                        if (isCorrect) {
                            session.quizScore += 10;
                        }
                        
                        this.updateWordFromQuiz(currentWord, isCorrect);
                        this.saveData();
                        this.triggerSync('complete_quiz_question', { 
                            word: currentWord.english, 
                            correct: isCorrect 
                        });
                        
                        setTimeout(() => {
                            session.currentQuizIndex++;
                            this.renderQuiz();
                        }, 1000);
                    });
                });
            }
            
            generateQuizOptions(word) {
                const options = [
                    { text: word.chinese, isCorrect: true }
                ];
                
                const otherWords = this.vocabulary
                    .filter(w => w.english !== word.english)
                    .sort(() => Math.random() - 0.5)
                    .slice(0, 3);
                
                otherWords.forEach(otherWord => {
                    options.push({
                        text: otherWord.chinese,
                        isCorrect: false
                    });
                });
                
                return options.sort(() => Math.random() - 0.5);
            }
            
            updateWordFromQuiz(word, isCorrect) {
                const originalWord = this.vocabulary.find(w => 
                    (w.id && w.id === word.id) || w.english === word.english
                );
                
                if (originalWord) {
                    if (isCorrect) {
                        originalWord.mastery = Math.min(100, originalWord.mastery + 15);
                        originalWord.correctCount = (originalWord.correctCount || 0) + 1;
                    } else {
                        originalWord.mastery = Math.max(0, originalWord.mastery - 10);
                    }
                    
                    originalWord.lastReviewed = new Date().toISOString();
                    originalWord.reviewCount = (originalWord.reviewCount || 0) + 1;
                }
                
                if (isCorrect && word.status === 'forgot') {
                    word.status = 'fuzzy';
                    word.mastery = 50;
                } else if (!isCorrect && word.status === 'fuzzy') {
                    word.status = 'forgot';
                    word.mastery = 15;
                }
            }
            
            // ÂÆåÊàêÊâìÂç°
            completeDailyCheckIn() {
                const session = this.studyState.currentSession;
                if (!session) return;
                
                const forgotWords = session.words.filter(w => w.status === 'forgot');
                
                if (forgotWords.length > 0) {
                    this.showNotification('ËøòÊúâÊ≤°Âç∞Ë±°ÁöÑÂçïËØçÔºåÈúÄË¶ÅÁªßÁª≠Â≠¶‰π†Áõ¥Âà∞Ëá≥Â∞ëËææÂà∞Ê®°Á≥äÁä∂ÊÄÅ', 'warning');
                    session.quizWords = forgotWords;
                    session.currentQuizIndex = 0;
                    this.renderQuiz();
                    return;
                }
                
                session.completed = true;
                session.endTime = new Date().toISOString();
                
                this.studyState.dailyCompleted = true;
                this.studyState.totalStudyTime += session.elapsedTime;
                this.studyState.currentSession = null;
                
                // ËÆ∞ÂΩïÂÆåÊàêÊó∂Èó¥
                const now = new Date();
                this.user.completionTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
                
                // Êõ¥Êñ∞ËøûÁª≠Â§©Êï∞
                this.updateStreakDays();
                
                // Áªô‰∫àÂ•ñÂä±
                this.giveDailyReward();
                
                this.saveData();
                this.triggerSync('complete_daily_checkin');
                
                this.showCompletionScreen();
            }
            
            updateStreakDays() {
                const today = new Date().toDateString();
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                
                if (!this.user.lastStudyDate) {
                    this.user.streakDays = 1;
                } else if (this.user.lastStudyDate === yesterday.toDateString()) {
                    this.user.streakDays++;
                } else if (this.user.lastStudyDate !== today) {
                    this.user.streakDays = 1;
                }
                
                this.user.lastStudyDate = today;
            }
            
            giveDailyReward() {
                let expReward = 100;
                const masteredCount = this.studyState.todayWords.mastered;
                if (masteredCount >= 8) expReward += 50;
                if (this.user.streakDays % 7 === 0) expReward += 100;
                
                this.user.exp += expReward;
                
                const oldLevel = this.user.level;
                const expNeeded = this.user.level * 100 + 50;
                if (this.user.exp >= expNeeded) {
                    this.user.level++;
                    this.user.exp -= expNeeded;
                }
                
                this.saveData();
            }
            
            showCompletionScreen() {
                const studyContent = document.getElementById('studyContent');
                const session = this.studyState.currentSession;
                
                if (!studyContent) return;
                
                const masteredCount = session.words.filter(w => w.status === 'mastered').length;
                const fuzzyCount = session.words.filter(w => w.status === 'fuzzy').length;
                
                studyContent.innerHTML = `
                    <div class="card" style="text-align: center; padding: 40px;">
                        <div style="font-size: 72px; color: var(--accent); margin-bottom: 20px;">
                            üéâ
                        </div>
                        <h2 style="margin-bottom: 20px;">‰ªäÊó•ÊâìÂç°ÂÆåÊàêÔºÅ</h2>
                        
                        <div style="margin: 30px 0;">
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 20px;">
                                <div style="padding: 15px; background: rgba(6, 214, 160, 0.1); border-radius: 10px;">
                                    <div style="font-size: 20px; font-weight: 700; color: var(--accent);">${masteredCount}</div>
                                    <div style="color: var(--gray); font-size: 14px;">Â∑≤ÊéåÊè°</div>
                                </div>
                                <div style="padding: 15px; background: rgba(255, 209, 102, 0.1); border-radius: 10px;">
                                    <div style="font-size: 20px; font-weight: 700; color: #E6B400;">${fuzzyCount}</div>
                                    <div style="color: var(--gray); font-size: 14px;">Ê®°Á≥ä</div>
                                </div>
                            </div>
                            
                            <div style="padding: 15px; background: rgba(79, 106, 245, 0.1); border-radius: 10px;">
                                <div style="font-size: 20px; font-weight: 700; color: var(--primary);">
                                    ‚úÖ ÊâÄÊúâÂçïËØçËá≥Â∞ëËææÂà∞Ê®°Á≥äÁä∂ÊÄÅ
                                </div>
                                <div style="color: var(--gray); font-size: 14px; margin-top: 5px;">
                                    Á¨¶ÂêàÊØèÊó•ÊâìÂç°ÂÆåÊàêÊù°‰ª∂
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin: 30px 0;">
                            <button class="btn btn-success" onclick="app.showRewardAnimation()" style="margin: 0 10px 10px 0;">
                                <i class="fas fa-gift"></i>
                                È¢ÜÂèñÂ•ñÂä±
                            </button>
                            <button class="btn" onclick="app.loadPage('dashboard')">
                                <i class="fas fa-home"></i>
                                ËøîÂõûÈ¶ñÈ°µ
                            </button>
                        </div>
                        
                        <div style="font-size: 14px; color: var(--gray); margin-top: 20px;">
                            <i class="fas fa-sync-alt"></i>
                            Êï∞ÊçÆÂ∑≤ÂêåÊ≠•Âà∞ÊïôÂ∏àÁ´Ø
                        </div>
                    </div>
                `;
            }
            
            showRewardAnimation() {
                this.createConfetti();
                
                document.getElementById('rewardContent').innerHTML = `
                    <div style="font-size: 72px; margin-bottom: 20px;">
                        üéÅ
                    </div>
                    <h3 style="margin-bottom: 20px;">ÊØèÊó•ÊâìÂç°Â•ñÂä±</h3>
                    <div style="font-size: 24px; color: var(--primary); font-weight: 700; margin-bottom: 20px;">
                        +100 EXP
                    </div>
                    <div style="color: var(--gray); margin-bottom: 30px;">
                        ËøûÁª≠Â≠¶‰π† ${this.user.streakDays} Â§©
                    </div>
                    <button class="btn btn-success" onclick="app.closeRewardAnimation()">
                        Â§™Ê£í‰∫ÜÔºÅ
                    </button>
                `;
                
                document.getElementById('rewardAnimation').classList.add('active');
                
                setTimeout(() => {
                    this.closeRewardAnimation();
                }, 5000);
            }
            
            createConfetti() {
                const container = document.getElementById('confettiContainer');
                container.innerHTML = '';
                container.classList.add('active');
                
                for (let i = 0; i < 150; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.background = this.getRandomColor();
                    confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                    
                    const animation = confetti.animate([
                        { top: '-20px', transform: `rotate(0deg)` },
                        { top: '100vh', transform: `rotate(${Math.random() * 720}deg)` }
                    ], {
                        duration: 3000 + Math.random() * 2000,
                        easing: 'cubic-bezier(0.215, 0.610, 0.355, 1)'
                    });
                    
                    container.appendChild(confetti);
                    
                    animation.onfinish = () => {
                        confetti.remove();
                    };
                }
                
                setTimeout(() => {
                    container.classList.remove('active');
                    container.innerHTML = '';
                }, 3000);
            }
            
            getRandomColor() {
                const colors = [
                    '#4F6AF5', '#06D6A0', '#FFD166', '#EF476F',
                    '#118AB2', '#073B4C', '#7209B7', '#F72585'
                ];
                return colors[Math.floor(Math.random() * colors.length)];
            }
            
            closeRewardAnimation() {
                document.getElementById('rewardAnimation').classList.remove('active');
                document.getElementById('confettiContainer').classList.remove('active');
                document.getElementById('confettiContainer').innerHTML = '';
            }
            
            handleTimeUp() {
                this.showNotification('Â≠¶‰π†Êó∂Èó¥Â∑≤Âà∞ÔºåÁ≥ªÁªüÂ∞ÜËá™Âä®‰øùÂ≠òËøõÂ∫¶', 'warning');
                
                const session = this.studyState.currentSession;
                if (session) {
                    session.elapsedTime += Math.floor((new Date() - new Date(session.startTime)) / 1000);
                    session.startTime = null;
                }
                
                this.saveData();
                this.triggerSync('study_time_up');
                this.loadPage('dashboard');
            }
            
            // ÂºÄÂßãËÆ≠ÁªÉ
            startTraining(type, newWordCount) {
                this.studyState.currentSession = {
                    type: type,
                    startTime: new Date().toISOString(),
                    elapsedTime: 0,
                    maxTime: 30 * 60,
                    currentPhase: 'flashcard',
                    currentBatch: 1,
                    totalBatches: Math.ceil(newWordCount / 10),
                    words: this.prepareTrainingWords(type, newWordCount),
                    currentWordIndex: 0,
                    flashcardResults: {},
                    quizResults: {},
                    completed: false
                };
                
                this.studyState.sessionStartTime = new Date().toISOString();
                this.saveData();
                this.triggerSync('start_training', { type, newWordCount });
                this.startFlashcardPhase();
            }
            
            prepareTrainingWords(type, newWordCount) {
                let words = [];
                
                switch(type) {
                    case 'new':
                        const newWords = this.vocabulary
                            .filter(word => word.mastery === 0)
                            .slice(0, newWordCount);
                        
                        const reviewWords = this.getReviewWords(10, 20);
                        words = [...reviewWords, ...newWords];
                        break;
                        
                    case 'weak':
                        words = this.vocabulary
                            .filter(word => word.mastery > 0 && word.mastery < 50)
                            .sort((a, b) => a.mastery - b.mastery)
                            .slice(0, 20);
                        break;
                        
                    case 'all':
                        words = this.vocabulary
                            .filter(word => word.mastery > 0)
                            .sort((a, b) => a.mastery - b.mastery)
                            .slice(0, 25);
                        break;
                        
                    case 'extra':
                        const extraNewWords = this.vocabulary
                            .filter(word => word.mastery === 0)
                            .slice(0, newWordCount);
                        
                        const extraReviewWords = this.getReviewWords(10, 20);
                        words = [...extraReviewWords, ...extraNewWords];
                        break;
                }
                
                return words.map(word => ({
                    ...word,
                    flashcardAppearances: 0,
                    maxFlashcards: this.getMaxFlashcards(word.mastery),
                    quizAppearances: 0,
                    status: 'pending'
                }));
            }
            
            restoreSession() {
                const session = this.studyState.currentSession;
                if (!session) return;
                
                if (session.startTime) {
                    const now = new Date();
                    const startTime = new Date(session.startTime);
                    session.elapsedTime += Math.floor((now - startTime) / 1000);
                    session.startTime = now.toISOString();
                }
                
                if (session.currentPhase === 'flashcard') {
                    this.startFlashcardPhase();
                } else if (session.currentPhase === 'quiz') {
                    this.startQuizPhase();
                }
            }
            
            saveStudyProgress() {
                const session = this.studyState.currentSession;
                if (session) {
                    if (session.startTime) {
                        const now = new Date();
                        const startTime = new Date(session.startTime);
                        session.elapsedTime += Math.floor((now - startTime) / 1000);
                        session.startTime = now.toISOString();
                    }
                    
                    this.showNotification('ËøõÂ∫¶Â∑≤‰øùÂ≠ò', 'success');
                }
                
                this.saveData();
                this.triggerSync('save_progress');
            }
            
            autoSaveProgress() {
                clearInterval(this.autoSaveTimer);
                
                this.autoSaveTimer = setInterval(() => {
                    this.saveStudyProgress();
                }, this.config.autoSaveInterval * 1000);
            }
            
            startAutoSave() {
                this.autoSaveTimer = setInterval(() => {
                    this.saveData();
                    this.syncToTeacher();
                }, 60000);
            }
            
            // Âä†ËΩΩÊ¶úÂçï
            loadLeaderboard() {
                const typeName = this.currentLeaderboardType === 'earliest' ? 'ÊúÄÊó©ÂÆåÊàêÊ¶ú' : 'ÂçïËØçÊéåÊè°Â§ßÂ∏àÊ¶ú';
                document.getElementById('leaderboardType').textContent = typeName;
                
                // Ëé∑ÂèñÊ¶úÂçïÊï∞ÊçÆÔºàÊ®°ÊãüÔºâ
                const leaderboardData = this.generateLeaderboardData();
                const leaderboardContent = document.getElementById('leaderboardContent');
                leaderboardContent.innerHTML = '';
                
                // Âè™ÊòæÁ§∫Ââç5Âêç
                const top5 = leaderboardData.slice(0, 5);
                let foundMe = false;
                let myRank = -1;
                
                top5.forEach((item, index) => {
                    if (item.isMe) {
                        foundMe = true;
                        myRank = index + 1;
                    }
                    
                    const rankClass = index === 0 ? 'rank-1' : 
                                    index === 1 ? 'rank-2' : 
                                    index === 2 ? 'rank-3' : 'rank-other';
                    
                    const rankText = index === 0 ? 'ü•á' : 
                                   index === 1 ? 'ü•à' : 
                                   index === 2 ? 'ü•â' : index + 1;
                    
                    // ÂåøÂêçÂåñÂ§ÑÁêÜ
                    let displayName = item.name;
                    if (!item.isMe) {
                        if (item.name.length >= 2) {
                            displayName = item.name[0] + 'Ôºä' + item.name[item.name.length - 1];
                        }
                    }
                    
                    const itemDiv = document.createElement('div');
                    itemDiv.className = `leaderboard-item ${item.isMe ? 'me' : ''}`;
                    itemDiv.innerHTML = `
                        <div class="leaderboard-rank ${rankClass}">${rankText}</div>
                        <div class="leaderboard-name">${displayName}</div>
                        <div class="leaderboard-score">${Math.round(item.score)}ÂàÜ</div>
                    `;
                    
                    leaderboardContent.appendChild(itemDiv);
                });
                
                // Â¶ÇÊûúÊ≤°ÊúâÂú®top5‰∏≠ÊâæÂà∞Ëá™Â∑±ÔºåÊòæÁ§∫Ëá™Â∑±
                if (!foundMe) {
                    const myData = leaderboardData.find(item => item.isMe);
                    if (myData) {
                        myRank = leaderboardData.indexOf(myData) + 1;
                        
                        const dotsDiv = document.createElement('div');
                        dotsDiv.className = 'leaderboard-dots';
                        dotsDiv.textContent = '...';
                        leaderboardContent.appendChild(dotsDiv);
                        
                        const myDiv = document.createElement('div');
                        myDiv.className = 'leaderboard-item me';
                        myDiv.innerHTML = `
                            <div class="leaderboard-rank rank-other">${myRank}</div>
                            <div class="leaderboard-name">‚≠ê Êàë</div>
                            <div class="leaderboard-score">${Math.round(myData.score)}ÂàÜ</div>
                        `;
                        leaderboardContent.appendChild(myDiv);
                    }
                }
                
                // Â¶ÇÊûúÊÄª‰∫∫Êï∞Ë∂ÖËøá5ÔºåÊ∑ªÂä†ÁúÅÁï•Âè∑
                if (leaderboardData.length > 5) {
                    const dotsDiv = document.createElement('div');
                    dotsDiv.className = 'leaderboard-dots';
                    dotsDiv.textContent = `ËøòÊúâ ${leaderboardData.length - 5} ‰ΩçÂêåÂ≠¶`;
                    leaderboardContent.appendChild(dotsDiv);
                }
            }
            
            // ÁîüÊàêÊ¶úÂçïÊï∞ÊçÆ
            generateLeaderboardData() {
                const leaderboardData = [];
                const todayCompletedStudents = [];
                
                // Ê∑ªÂä†Ëá™Â∑±
                if (this.user.completionTime) {
                    const myScore = this.calculateMyScore();
                    leaderboardData.push({
                        id: this.user.id,
                        name: this.user.name,
                        score: myScore,
                        isMe: true,
                        completionTime: this.user.completionTime,
                        masteredWords: this.vocabulary.filter(w => w.mastery >= 70).length,
                        streakDays: this.user.streakDays
                    });
                    
                    todayCompletedStudents.push({
                        name: this.user.name,
                        completionTime: this.user.completionTime
                    });
                }
                
                // Ê∑ªÂä†ËôöÊûÑÊï∞ÊçÆ
                const studentCount = Math.max(8, 3 + Math.floor(Math.random() * 10));
                
                for (let i = 0; i < studentCount; i++) {
                    const name = ENGLISH_NAMES[Math.floor(Math.random() * ENGLISH_NAMES.length)];
                    
                    // ÈöèÊú∫ÁîüÊàêÂÆåÊàêÊó∂Èó¥ÔºàÂ¶ÇÊûúÊòØÊúÄÊó©ÂÆåÊàêÊ¶úÔºâ
                    let completionTime = null;
                    if (Math.random() > 0.3) { // 70%ÁöÑÂ≠¶ÁîüÂÆåÊàê‰∫Ü‰ªäÊó•ÊâìÂç°
                        const hour = Math.floor(Math.random() * 24);
                        const minute = Math.floor(Math.random() * 60);
                        completionTime = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                        todayCompletedStudents.push({ name, completionTime });
                    }
                    
                    // ËÆ°ÁÆóÂàÜÊï∞
                    let score = 0;
                    if (this.currentLeaderboardType === 'earliest' && completionTime) {
                        score = LeaderboardCalculator.calculateEarliestCompletionScore(completionTime);
                    } else if (this.currentLeaderboardType === 'mastery') {
                        const masteredWords = Math.floor(Math.random() * 100) + 50;
                        const totalProficiency = masteredWords * 75 + Math.random() * 1000;
                        const streakDays = Math.floor(Math.random() * 30) + 1;
                        const accuracy = 70 + Math.random() * 25;
                        
                        score = LeaderboardCalculator.calculateMasteryScore({
                            masteredWords,
                            totalProficiency,
                            streakDays,
                            accuracy
                        });
                    }
                    
                    leaderboardData.push({
                        id: `S${1000 + i}`,
                        name: name,
                        score: score,
                        isMe: false,
                        completionTime: completionTime,
                        masteredWords: Math.floor(Math.random() * 100) + 50,
                        streakDays: Math.floor(Math.random() * 30) + 1
                    });
                }
                
                // ÊéíÂ∫è
                if (this.currentLeaderboardType === 'earliest') {
                    // ÊúÄÊó©ÂÆåÊàêÊ¶úÔºöÊåâÂÆåÊàêÊó∂Èó¥ÊéíÂ∫è
                    leaderboardData.sort((a, b) => {
                        if (!a.completionTime && !b.completionTime) return 0;
                        if (!a.completionTime) return 1;
                        if (!b.completionTime) return -1;
                        
                        const [aHour, aMinute] = a.completionTime.split(':').map(Number);
                        const [bHour, bMinute] = b.completionTime.split(':').map(Number);
                        
                        if (aHour !== bHour) return aHour - bHour;
                        return aMinute - bMinute;
                    });
                } else {
                    // ÊéåÊè°Â§ßÂ∏àÊ¶úÔºöÊåâÂàÜÊï∞ÈôçÂ∫è
                    leaderboardData.sort((a, b) => b.score - a.score);
                }
                
                return leaderboardData;
            }
            
            calculateMyScore() {
                if (this.currentLeaderboardType === 'earliest') {
                    if (!this.user.completionTime) return 0;
                    return LeaderboardCalculator.calculateEarliestCompletionScore(this.user.completionTime);
                } else {
                    const masteredWords = this.vocabulary.filter(w => w.mastery >= 70).length;
                    const totalProficiency = this.vocabulary.reduce((sum, word) => sum + word.mastery, 0);
                    const accuracy = this.vocabulary.length > 0 ? 
                        (this.vocabulary.reduce((sum, word) => sum + (word.correctCount || 0), 0) / 
                         this.vocabulary.reduce((sum, word) => sum + (word.reviewCount || 1), 0)) * 100 : 0;
                    
                    return LeaderboardCalculator.calculateMasteryScore({
                        masteredWords,
                        totalProficiency,
                        streakDays: this.user.streakDays,
                        accuracy
                    });
                }
            }
            
            refreshLeaderboard() {
                // ËΩÆÊç¢Ê¶úÂçïÁ±ªÂûã
                this.currentLeaderboardType = this.currentLeaderboardType === 'earliest' ? 'mastery' : 'earliest';
                this.loadLeaderboard();
                this.showNotification('Ê¶úÂçïÂ∑≤Âà∑Êñ∞', 'info');
            }
            
            // ‰øùÂ≠òÊï∞ÊçÆ
            saveData() {
                localStorage.setItem('userId', this.user.id);
                localStorage.setItem('userName', this.user.name);
                localStorage.setItem('userLevel', this.user.level.toString());
                localStorage.setItem('userExp', this.user.exp.toString());
                localStorage.setItem('streakDays', this.user.streakDays.toString());
                localStorage.setItem('lastStudyDate', this.user.lastStudyDate);
                localStorage.setItem('completionTime', this.user.completionTime);
                localStorage.setItem('todayCompleted', this.studyState.dailyCompleted.toString());
                localStorage.setItem('studyState', JSON.stringify(this.studyState));
                localStorage.setItem('studyConfig', JSON.stringify(this.config));
                localStorage.setItem('vocabulary', JSON.stringify(this.vocabulary));
                localStorage.setItem('praises', JSON.stringify(this.praises));
                localStorage.setItem('achievements', JSON.stringify(this.achievements));
            }
            
            // ‰ª•‰∏ãÊòØ‰øùÊåÅÂéüÊ†∑ÁöÑÂäüËÉΩ
            renderProgressPage() {
                const stats = this.getTodayStats();
                const totalWords = this.vocabulary.length;
                const masteredWords = this.vocabulary.filter(w => w.mastery >= 70).length;
                const fuzzyWords = this.vocabulary.filter(w => w.mastery >= 30 && w.mastery < 70).length;
                const forgotWords = this.vocabulary.filter(w => w.mastery < 30 && w.mastery > 0).length;
                const newWords = this.vocabulary.filter(w => w.mastery === 0).length;
                
                return `
                    <h1 class="page-title">Â≠¶‰π†ËøõÂ∫¶</h1>
                    <p class="page-subtitle">‰ªäÊó•Â≠¶‰π†ÁªüËÆ°‰∏éÂçïËØçÊéåÊè°ÊÉÖÂÜµ</p>
                    
                    <div class="card" style="margin-bottom: 25px;">
                        <div class="card-header">
                            <h3 class="card-title">üìä ‰ªäÊó•Â≠¶‰π†ËøõÂ∫¶</h3>
                            <div class="card-icon">
                                <i class="fas fa-chart-bar"></i>
                            </div>
                        </div>
                        
                        <div style="margin: 20px 0;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <div>
                                    <div style="font-size: 18px; font-weight: 600;">‰ªäÊó•Êñ∞ËØçËøõÂ∫¶</div>
                                    <div style="color: var(--gray); font-size: 14px;">${stats.learnedToday}/${stats.totalNewWords} ‰∏™</div>
                                </div>
                                <div style="font-size: 18px; font-weight: 700; color: var(--accent);">
                                    ${stats.progressPercent}%
                                </div>
                            </div>
                            <div class="progress-bar" style="height: 12px; margin-bottom: 25px;">
                                <div class="progress-fill" style="width: ${stats.progressPercent}%; background: linear-gradient(90deg, var(--primary), var(--accent));"></div>
                            </div>
                            
                            ${stats.progressPercent === 100 ? `
                                <div style="text-align: center; padding: 15px; background: rgba(6, 214, 160, 0.1); border-radius: 10px; margin-bottom: 20px;">
                                    <div style="color: var(--accent); font-weight: 600; margin-bottom: 5px;">
                                        <i class="fas fa-check-circle"></i> ‰ªäÊó•ÊâìÂç°Â∑≤ÂÆåÊàê
                                    </div>
                                    <div style="color: var(--gray); font-size: 14px;">
                                        Â∑≤ÊéåÊè° ${stats.mastered} ‰∏™Êñ∞ËØçÔºåÊ®°Á≥ä ${stats.fuzzy} ‰∏™
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="study-progress-container">
                            <div class="progress-card progress-card-0" onclick="app.showWordList('today')">
                                <div class="progress-card-title">
                                    <i class="fas fa-calendar-day"></i> ‰ªäÊó•Â∑≤Â≠¶
                                </div>
                                <div class="progress-card-count">${stats.learnedToday}</div>
                                <div class="progress-card-subtitle">Êñ∞ËØçÊï∞Èáè</div>
                            </div>
                            
                            <div class="progress-card progress-card-1" onclick="app.showWordList('mastered')">
                                <div class="progress-card-title">
                                    <i class="fas fa-check-circle"></i> Â∑≤ÊéåÊè°
                                </div>
                                <div class="progress-card-count">${masteredWords}</div>
                                <div class="progress-card-subtitle">ÁÜüÁªÉÂ∫¶ ‚â• 70</div>
                            </div>
                            
                            <div class="progress-card progress-card-2" onclick="app.showWordList('fuzzy')">
                                <div class="progress-card-title">
                                    <i class="fas fa-question-circle"></i> Ê®°Á≥ä
                                </div>
                                <div class="progress-card-count">${fuzzyWords}</div>
                                <div class="progress-card-subtitle">30 ‚â§ ÁÜüÁªÉÂ∫¶ < 70</div>
                            </div>
                            
                            <div class="progress-card progress-card-3" onclick="app.showWordList('forgot')">
                                <div class="progress-card-title">
                                    <i class="fas fa-exclamation-circle"></i> ÈúÄÂ§ç‰π†
                                </div>
                                <div class="progress-card-count">${forgotWords}</div>
                                <div class="progress-card-subtitle">ÁÜüÁªÉÂ∫¶ < 30</div>
                            </div>
                            
                            <div class="progress-card progress-card-4" onclick="app.showWordList('new')">
                                <div class="progress-card-title">
                                    <i class="fas fa-plus-circle"></i> Êú™Â≠¶‰π†
                                </div>
                                <div class="progress-card-count">${newWords}</div>
                                <div class="progress-card-subtitle">Á≠âÂæÖÂ≠¶‰π†</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üìà Êï¥‰ΩìÊéåÊè°ÊÉÖÂÜµ</h3>
                            <div class="card-icon">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                <div>
                                    <div style="font-size: 24px; font-weight: 700; color: var(--dark);">${totalWords}</div>
                                    <div style="color: var(--gray); font-size: 14px;">ÊÄªÂçïËØçÊï∞</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 24px; font-weight: 700; color: var(--accent);">
                                        ${totalWords > 0 ? Math.round(masteredWords / totalWords * 100) : 0}%
                                    </div>
                                    <div style="color: var(--gray); font-size: 14px;">ÊÄªÊéåÊè°Áéá</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            setupProgressEvents() {}
            
            showWordList(type) {
                let words = [];
                let title = '';
                
                switch(type) {
                    case 'today':
                        const today = new Date().toDateString();
                        words = this.vocabulary.filter(word => 
                            word.lastReviewed && new Date(word.lastReviewed).toDateString() === today
                        );
                        title = '‰ªäÊó•Â∑≤Â≠¶ÂçïËØç';
                        break;
                        
                    case 'mastered':
                        words = this.vocabulary.filter(w => w.mastery >= 70);
                        title = 'Â∑≤ÊéåÊè°ÂçïËØç';
                        break;
                        
                    case 'fuzzy':
                        words = this.vocabulary.filter(w => w.mastery >= 30 && w.mastery < 70);
                        title = 'Ê®°Á≥äÂçïËØç';
                        break;
                        
                    case 'forgot':
                        words = this.vocabulary.filter(w => w.mastery < 30 && w.mastery > 0);
                        title = 'ÈúÄÂ§ç‰π†ÂçïËØç';
                        break;
                        
                    case 'new':
                        words = this.vocabulary.filter(w => w.mastery === 0);
                        title = 'Êú™Â≠¶‰π†ÂçïËØç';
                        break;
                }
                
                this.showModal(`
                    <h3 style="margin-bottom: 20px;">${title} (${words.length}‰∏™)</h3>
                    <div class="table-container" style="max-height: 400px;">
                        <table>
                            <thead>
                                <tr>
                                    <th>ÂçïËØç</th>
                                    <th>Èáä‰πâ</th>
                                    <th>ÁÜüÁªÉÂ∫¶</th>
                                    <th>ÊúÄÂêéÂ§ç‰π†</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${words.map(word => {
                                    const stars = Math.floor(word.mastery / 20);
                                    const starHtml = '‚òÖ'.repeat(stars) + '‚òÜ'.repeat(5 - stars);
                                    
                                    let lastReviewedText = 'Êú™Â§ç‰π†';
                                    if (word.lastReviewed) {
                                        const reviewDate = new Date(word.lastReviewed);
                                        const now = new Date();
                                        const diffDays = Math.floor((now - reviewDate) / (1000 * 60 * 60 * 24));
                                        
                                        if (diffDays === 0) {
                                            lastReviewedText = '‰ªäÊó•';
                                        } else if (diffDays === 1) {
                                            lastReviewedText = 'Êò®Â§©';
                                        } else {
                                            lastReviewedText = `${diffDays}Â§©Ââç`;
                                        }
                                    }
                                    
                                    return `
                                        <tr>
                                            <td><strong>${word.english}</strong></td>
                                            <td>${word.chinese}</td>
                                            <td>
                                                <div style="color: #FFD700;">${starHtml}</div>
                                                <div style="font-size: 12px; color: var(--gray);">${word.mastery}ÂàÜ</div>
                                            </td>
                                            <td>${lastReviewedText}</td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <button class="btn" onclick="app.startTraining('${type}', ${type === 'new' ? 10 : 0})">
                            <i class="fas fa-play"></i>
                            ÂºÄÂßãÂ≠¶‰π†Ëøô‰∫õÂçïËØç
                        </button>
                    </div>
                `);
            }
            
            renderVocabulary() {
                const masteredCount = this.vocabulary.filter(w => w.mastery >= 70).length;
                const fuzzyCount = this.vocabulary.filter(w => w.mastery >= 30 && w.mastery < 70).length;
                const needReviewCount = this.vocabulary.filter(w => w.mastery < 30).length;
                
                return `
                    <h1 class="page-title">ÂçïËØçÊú¨</h1>
                    <p class="page-subtitle">Â∑≤Êî∂ÂΩï ${this.vocabulary.length} ‰∏™ÂçïËØç</p>
                    
                    <div class="grid" style="margin-bottom: 30px;">
                        <div class="card">
                            <div style="display: flex; align-items: center; justify-content: space-between;">
                                <div>
                                    <div style="font-size: 24px; font-weight: 700; color: var(--accent);">${masteredCount}</div>
                                    <div style="color: var(--gray); font-size: 14px;">Â∑≤ÊéåÊè°</div>
                                </div>
                                <div class="card-icon">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div style="display: flex; align-items: center; justify-content: space-between;">
                                <div>
                                    <div style="font-size: 24px; font-weight: 700; color: #E6B400;">${fuzzyCount}</div>
                                    <div style="color: var(--gray); font-size: 14px;">Ê®°Á≥ä</div>
                                </div>
                                <div class="card-icon">
                                    <i class="fas fa-question-circle"></i>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div style="display: flex; align-items: center; justify-content: space-between;">
                                <div>
                                    <div style="font-size: 24px; font-weight: 700; color: var(--danger);">${needReviewCount}</div>
                                    <div style="color: var(--gray); font-size: 14px;">ÈúÄÂ§ç‰π†</div>
                                </div>
                                <div class="card-icon">
                                    <i class="fas fa-exclamation-circle"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <div>
                                <button class="action-btn" id="filterAll" style="margin-right: 10px;">ÂÖ®ÈÉ®</button>
                                <button class="action-btn" id="filterMastered" style="margin-right: 10px;">Â∑≤ÊéåÊè°</button>
                                <button class="action-btn" id="filterFuzzy" style="margin-right: 10px;">Ê®°Á≥ä</button>
                                <button class="action-btn" id="filterNeedReview">ÈúÄÂ§ç‰π†</button>
                            </div>
                            <div>
                                <input type="text" id="searchWord" placeholder="ÊêúÁ¥¢ÂçïËØç..." style="padding: 8px 12px; border: 1px solid rgba(0,0,0,0.1); border-radius: 6px; width: 200px;">
                            </div>
                        </div>
                        
                        <div class="table-container" id="vocabularyTable">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ÂçïËØç</th>
                                        <th>Èáä‰πâ</th>
                                        <th>ÁÜüÁªÉÂ∫¶</th>
                                        <th>ÊúÄÂêéÂ§ç‰π†</th>
                                        <th>Áä∂ÊÄÅ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${this.renderVocabularyRows()}
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="text-align: center; margin-top: 20px; color: var(--gray);">
                            ÂÖ± ${this.vocabulary.length} ‰∏™ÂçïËØç
                        </div>
                    </div>
                `;
            }
            
            renderVocabularyRows(filter = 'all', search = '') {
                let filteredWords = [...this.vocabulary];
                
                if (filter === 'mastered') {
                    filteredWords = filteredWords.filter(w => w.mastery >= 70);
                } else if (filter === 'fuzzy') {
                    filteredWords = filteredWords.filter(w => w.mastery >= 30 && w.mastery < 70);
                } else if (filter === 'needReview') {
                    filteredWords = filteredWords.filter(w => w.mastery < 30);
                }
                
                if (search) {
                    const searchLower = search.toLowerCase();
                    filteredWords = filteredWords.filter(w => 
                        w.english.toLowerCase().includes(searchLower) || 
                        w.chinese.toLowerCase().includes(searchLower)
                    );
                }
                
                filteredWords.sort((a, b) => a.mastery - b.mastery);
                
                if (filteredWords.length === 0) {
                    return `
                        <tr>
                            <td colspan="5" style="text-align: center; padding: 40px; color: var(--gray);">
                                <i class="fas fa-search" style="font-size: 24px; margin-bottom: 10px; display: block;"></i>
                                ÊöÇÊó†ÂçïËØçÊï∞ÊçÆ
                            </td>
                        </tr>
                    `;
                }
                
                return filteredWords.map(word => {
                    const stars = Math.floor(word.mastery / 20);
                    const starHtml = '‚òÖ'.repeat(stars) + '‚òÜ'.repeat(5 - stars);
                    
                    let statusBadge = '';
                    let statusColor = '';
                    if (word.mastery >= 70) {
                        statusBadge = '‚úÖ Â∑≤ÊéåÊè°';
                        statusColor = 'var(--accent)';
                    } else if (word.mastery >= 30) {
                        statusBadge = '‚ö†Ô∏è Ê®°Á≥ä';
                        statusColor = '#E6B400';
                    } else {
                        statusBadge = 'üìå ÈúÄÂ§ç‰π†';
                        statusColor = 'var(--danger)';
                    }
                    
                    let lastReviewedText = 'Êú™Â§ç‰π†';
                    if (word.lastReviewed) {
                        const reviewDate = new Date(word.lastReviewed);
                        const now = new Date();
                        const diffDays = Math.floor((now - reviewDate) / (1000 * 60 * 60 * 24));
                        
                        if (diffDays === 0) {
                            lastReviewedText = '‰ªäÊó•';
                        } else if (diffDays === 1) {
                            lastReviewedText = 'Êò®Â§©';
                        } else {
                            lastReviewedText = `${diffDays}Â§©Ââç`;
                        }
                    }
                    
                    return `
                        <tr>
                            <td><strong>${word.english}</strong></td>
                            <td>${word.chinese}</td>
                            <td>
                                <div style="color: #FFD700; margin-bottom: 4px;">${starHtml}</div>
                                <div style="font-size: 12px; color: var(--gray);">${word.mastery}ÂàÜ</div>
                            </td>
                            <td>${lastReviewedText}</td>
                            <td><span style="color: ${statusColor}; font-weight: 500;">${statusBadge}</span></td>
                        </tr>
                    `;
                }).join('');
            }
            
            setupVocabularyEvents() {
                document.getElementById('filterAll')?.addEventListener('click', () => {
                    this.updateVocabularyTable('all');
                });
                document.getElementById('filterMastered')?.addEventListener('click', () => {
                    this.updateVocabularyTable('mastered');
                });
                document.getElementById('filterFuzzy')?.addEventListener('click', () => {
                    this.updateVocabularyTable('fuzzy');
                });
                document.getElementById('filterNeedReview')?.addEventListener('click', () => {
                    this.updateVocabularyTable('needReview');
                });
                
                document.getElementById('searchWord')?.addEventListener('input', (e) => {
                    const searchText = e.target.value;
                    this.updateVocabularyTable('all', searchText);
                });
            }
            
            updateVocabularyTable(filter, search = '') {
                const tableBody = document.querySelector('#vocabularyTable tbody');
                if (tableBody) {
                    tableBody.innerHTML = this.renderVocabularyRows(filter, search);
                }
            }
            
            renderAchievements() {
                const badges = [
                    { id: 1, icon: 'fas fa-fire', name: '‰∏âÊó•Êñ∞Êòü', desc: 'ËøûÁª≠Â≠¶‰π†3Â§©', earned: this.user.streakDays >= 3, progress: Math.min(this.user.streakDays, 3), target: 3 },
                    { id: 2, icon: 'fas fa-rocket', name: 'Âë®ÂùöÊåÅËÄÖ', desc: 'ËøûÁª≠Â≠¶‰π†7Â§©', earned: this.user.streakDays >= 7, progress: Math.min(this.user.streakDays, 7), target: 7 },
                    { id: 3, icon: 'fas fa-check-circle', name: 'ÂáÜÁ°ÆÂ§ßÂ∏à', desc: 'ÂçïÊ¨°Ê≠£Á°ÆÁéá>90%', earned: false, progress: 0, target: 1 },
                    { id: 4, icon: 'fas fa-bolt', name: 'Âø´ÈÄüÂ≠¶‰π†ËÄÖ', desc: 'Áî®Êó∂<10ÂàÜÈíüÂÆåÊàê', earned: false, progress: 0, target: 1 },
                    { id: 5, icon: 'fas fa-star', name: 'ÂçïËØçÊé¢Á¥¢ËÄÖ', desc: 'ÊéåÊè°100‰∏™ÂçïËØç', earned: this.vocabulary.filter(w => w.mastery >= 70).length >= 100, progress: Math.min(this.vocabulary.filter(w => w.mastery >= 70).length, 100), target: 100 },
                    { id: 6, icon: 'fas fa-crown', name: 'ËØçÊ±áËææ‰∫∫', desc: 'ÊéåÊè°500‰∏™ÂçïËØç', earned: this.vocabulary.filter(w => w.mastery >= 70).length >= 500, progress: Math.min(this.vocabulary.filter(w => w.mastery >= 70).length, 500), target: 500 },
                    { id: 7, icon: 'fas fa-graduation-cap', name: 'ËØ≠Ë®ÄÂ§ßÂ∏à', desc: 'ÊéåÊè°1000‰∏™ÂçïËØç', earned: this.vocabulary.filter(w => w.mastery >= 70).length >= 1000, progress: Math.min(this.vocabulary.filter(w => w.mastery >= 70).length, 1000), target: 1000 },
                    { id: 8, icon: 'fas fa-award', name: 'Êó©Ëµ∑È∏üÂÑø', desc: '7:00ÂâçÂÆåÊàêÂ≠¶‰π†', earned: false, progress: 0, target: 1 },
                ];
                
                const earnedCount = badges.filter(b => b.earned).length;
                const totalCount = badges.length;
                
                return `
                    <h1 class="page-title">ÊàêÂ∞±ÂæΩÁ´†</h1>
                    <p class="page-subtitle">Â∑≤Ëé∑Âæó ${earnedCount}/${totalCount} ‰∏™ÂæΩÁ´†</p>
                    
                    ${this.praises.length > 0 ? `
                        <div class="card" style="margin-bottom: 30px;">
                            <div class="card-header">
                                <h3 class="card-title">üéâ ÊïôÂ∏àË°®Êâ¨ËÆ∞ÂΩï</h3>
                                <div class="card-icon">
                                    <i class="fas fa-award"></i>
                                </div>
                            </div>
                            <div style="margin-top: 20px;">
                                ${this.praises.map(praise => `
                                    <div style="padding: 15px; background: ${praise.read ? 'rgba(0,0,0,0.02)' : 'rgba(6, 214, 160, 0.1)'}; border-radius: 10px; margin-bottom: 10px; border-left: 4px solid ${praise.read ? 'var(--gray)' : 'var(--accent)'};">
                                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 5px;">
                                            <div style="font-weight: 600; color: var(--accent);">
                                                ${praise.teacher} ¬∑ ${praise.type}
                                            </div>
                                            ${!praise.read ? `
                                                <button class="action-btn" onclick="app.markPraiseAsRead(${praise.id})" style="font-size: 12px; padding: 4px 8px;">
                                                    Ê†áËÆ∞Â∑≤ËØª
                                                </button>
                                            ` : ''}
                                        </div>
                                        <div>${praise.message}</div>
                                        <div style="font-size: 12px; color: var(--gray); margin-top: 5px;">
                                            ${new Date(praise.time).toLocaleString()}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üèÜ ÊàêÂ∞±ÂæΩÁ´†Â¢ô</h3>
                            <div class="card-icon">
                                <i class="fas fa-trophy"></i>
                            </div>
                        </div>
                        
                        <div class="badge-grid">
                            ${badges.map(badge => `
                                <div class="badge-card ${badge.earned ? '' : 'locked'}" onclick="app.showBadgeDetail(${badge.id})" style="cursor: pointer;">
                                    <i class="${badge.icon}"></i>
                                    <h4 style="margin-bottom: 8px;">${badge.name}</h4>
                                    <p style="color: var(--gray); font-size: 12px; margin-bottom: 10px;">${badge.desc}</p>
                                    ${badge.earned ? `
                                        <div style="color: var(--accent); font-size: 12px; font-weight: 600;">
                                            <i class="fas fa-check"></i> Â∑≤Ëé∑Âæó
                                        </div>
                                    ` : `
                                        <div style="font-size: 12px; color: var(--gray);">
                                            ËøõÂ∫¶: ${badge.progress}/${badge.target}
                                        </div>
                                        <div class="progress-bar" style="height: 4px; margin-top: 8px;">
                                            <div class="progress-fill" style="width: ${(badge.progress / badge.target) * 100}%"></div>
                                        </div>
                                    `}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            setupAchievementEvents() {}
            
            markPraiseAsRead(praiseId) {
                const praiseIndex = this.praises.findIndex(p => p.id === praiseId);
                if (praiseIndex !== -1) {
                    this.praises[praiseIndex].read = true;
                    localStorage.setItem('praises', JSON.stringify(this.praises));
                    this.loadPage('achievements');
                }
            }
            
            showBadgeDetail(badgeId) {
                this.showNotification('ÂæΩÁ´†ËØ¶ÊÉÖÂäüËÉΩÂºÄÂèë‰∏≠', 'info');
            }
            
            renderSettings() {
                return `
                    <h1 class="page-title">ËÆæÁΩÆ</h1>
                    <p class="page-subtitle">‰∏™ÊÄßÂåñ‰Ω†ÁöÑÂ≠¶‰π†‰ΩìÈ™å</p>
                    
                    <div class="grid">
                        <div class="card">
                            <h3 style="margin-bottom: 20px;">üé® Â≠¶‰π†ÂÅèÂ•Ω</h3>
                            <div class="form-group">
                                <label>ÊØèÊó•ÊèêÈÜíÊó∂Èó¥</label>
                                <select class="reminder-time" style="width: 100%; padding: 10px;">
                                    <option>‰∏çÊèêÈÜí</option>
                                    <option>18:00</option>
                                    <option>19:00</option>
                                    <option>20:00</option>
                                    <option>21:00</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label>ÊØèÊó•Â≠¶‰π†ÁõÆÊ†á</label>
                                <select class="daily-goal" style="width: 100%; padding: 10px;">
                                    <option value="5">5‰∏™Êñ∞ÂçïËØç</option>
                                    <option value="10" selected>10‰∏™Êñ∞ÂçïËØç</option>
                                    <option value="15">15‰∏™Êñ∞ÂçïËØç</option>
                                    <option value="20">20‰∏™Êñ∞ÂçïËØç</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label>Â≠¶‰π†Èü≥Êïà</label>
                                <div style="margin-top: 8px;">
                                    <label style="display: flex; align-items: center; margin-bottom: 10px;">
                                        <input type="checkbox" class="sound-effect" data-type="complete" checked>
                                        <span style="margin-left: 8px;">ÂÆåÊàêÊèêÁ§∫Èü≥</span>
                                    </label>
                                    <label style="display: flex; align-items: center; margin-bottom: 10px;">
                                        <input type="checkbox" class="sound-effect" data-type="correct" checked>
                                        <span style="margin-left: 8px;">Ê≠£Á°ÆÈü≥Êïà</span>
                                    </label>
                                    <label style="display: flex; align-items: center;">
                                        <input type="checkbox" class="sound-effect" data-type="levelup" checked>
                                        <span style="margin-left: 8px;">ÂçáÁ∫ßÈü≥Êïà</span>
                                    </label>
                                </div>
                            </div>
                            
                            <button class="btn" onclick="app.saveSettings()" style="width: 100%; margin-top: 20px;">
                                <i class="fas fa-save"></i>
                                ‰øùÂ≠òËÆæÁΩÆ
                            </button>
                        </div>
                        
                        <div class="card">
                            <h3 style="margin-bottom: 20px;">üë§ ‰∏™‰∫∫‰ø°ÊÅØ</h3>
                            <div class="form-group">
                                <label>ÊòµÁß∞</label>
                                <input type="text" class="user-nickname" value="${this.user.name}" placeholder="ËæìÂÖ•‰Ω†ÁöÑÊòµÁß∞">
                            </div>
                            
                            <div class="form-group">
                                <label>Â≠¶‰π†ÂàÜÁªÑ</label>
                                <div style="margin-top: 8px;">
                                    ${this.user.groups.map(group => `
                                        <div style="display: inline-block; padding: 6px 12px; background: rgba(79, 106, 245, 0.1); border-radius: 6px; margin: 0 8px 8px 0; font-size: 14px;">
                                            <i class="fas fa-book" style="margin-right: 6px;"></i>
                                            ${group}
                                        </div>
                                    `).join('')}
                                    ${this.user.groups.length === 0 ? `
                                        <div style="color: var(--gray); font-size: 14px;">
                                            <i class="fas fa-info-circle"></i> ÊöÇÊó†ÂàÜÁªÑÔºåËØ∑ËÅîÁ≥ªÊïôÂ∏àÊ∑ªÂä†
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>Â≠¶ÁîüID</label>
                                <input type="text" value="${this.user.id}" readonly style="background: var(--light);">
                                <div style="font-size: 12px; color: var(--gray); margin-top: 5px;">Áî®‰∫éÊïôÂ∏àËØÜÂà´‰Ω†ÁöÑË∫´‰ªΩ</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3 style="margin-bottom: 20px;">‚öôÔ∏è Êï∞ÊçÆÁÆ°ÁêÜ</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <button class="action-btn" onclick="app.exportData()">
                                <i class="fas fa-download"></i>
                                ÂØºÂá∫Â≠¶‰π†Êï∞ÊçÆ
                            </button>
                            <button class="action-btn" onclick="app.clearCache()">
                                <i class="fas fa-trash-alt"></i>
                                Ê∏ÖÁ©∫Êú¨Âú∞ÁºìÂ≠ò
                            </button>
                            <button class="action-btn" style="color: var(--danger);" onclick="app.resetProgress()">
                                <i class="fas fa-redo"></i>
                                ÈáçÁΩÆÂ≠¶‰π†ËøõÂ∫¶
                            </button>
                        </div>
                        <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(0,0,0,0.1);">
                            <div style="font-size: 12px; color: var(--gray);">
                                <i class="fas fa-info-circle"></i> Êï∞ÊçÆÊúÄÂêéÂêåÊ≠•: ${new Date().toLocaleString()}
                            </div>
                        </div>
                    </div>
                `;
            }
            
            setupSettingsEvents() {
                const savedSettings = JSON.parse(localStorage.getItem('userSettings')) || {};
                
                const reminderSelect = document.querySelector('.reminder-time');
                if (reminderSelect && savedSettings.reminderTime) {
                    reminderSelect.value = savedSettings.reminderTime;
                }
                
                const dailyGoalSelect = document.querySelector('.daily-goal');
                if (dailyGoalSelect) {
                    dailyGoalSelect.value = savedSettings.dailyGoal || '10';
                    this.config.dailyNewWords = parseInt(dailyGoalSelect.value);
                }
                
                const soundEffects = savedSettings.soundEffects || { complete: true, correct: true, levelup: true };
                document.querySelectorAll('.sound-effect').forEach(checkbox => {
                    const type = checkbox.dataset.type;
                    checkbox.checked = soundEffects[type] !== false;
                });
                
                const nicknameInput = document.querySelector('.user-nickname');
                if (nicknameInput) {
                    nicknameInput.value = this.user.name;
                }
            }
            
            saveSettings() {
                const settings = {
                    reminderTime: document.querySelector('.reminder-time').value,
                    dailyGoal: document.querySelector('.daily-goal').value,
                    soundEffects: {
                        complete: document.querySelector('.sound-effect[data-type="complete"]').checked,
                        correct: document.querySelector('.sound-effect[data-type="correct"]').checked,
                        levelup: document.querySelector('.sound-effect[data-type="levelup"]').checked
                    }
                };
                
                this.config.dailyNewWords = parseInt(settings.dailyGoal);
                
                const nickname = document.querySelector('.user-nickname').value;
                if (nickname && nickname !== this.user.name) {
                    this.user.name = nickname;
                    localStorage.setItem('userName', nickname);
                    this.loadUserInfo();
                }
                
                localStorage.setItem('userSettings', JSON.stringify(settings));
                this.showNotification('ËÆæÁΩÆÂ∑≤‰øùÂ≠ò', 'success');
            }
            
            exportData() {
                const data = {
                    user: this.user,
                    vocabulary: this.vocabulary,
                    studyData: this.studyState,
                    praises: this.praises,
                    achievements: this.achievements,
                    exportTime: new Date().toISOString()
                };
                
                const dataStr = JSON.stringify(data, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const downloadLink = document.createElement('a');
                downloadLink.href = URL.createObjectURL(dataBlob);
                downloadLink.download = `ÂçïËØçÂ§ßÂ∏àÂ≠¶‰π†Êï∞ÊçÆ_${this.user.id}_${new Date().toISOString().split('T')[0]}.json`;
                downloadLink.click();
                
                this.showNotification('Êï∞ÊçÆÂØºÂá∫ÊàêÂäü', 'success');
            }
            
            clearCache() {
                if (confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫Êú¨Âú∞ÁºìÂ≠òÂêóÔºüËøôÂ∞ÜÂà†Èô§ÊâÄÊúâÊú¨Âú∞ËÆæÁΩÆÔºå‰ΩÜ‰∏ç‰ºöÂà†Èô§Â≠¶‰π†ËÆ∞ÂΩï„ÄÇ')) {
                    localStorage.removeItem('userSettings');
                    localStorage.removeItem('notifications');
                    this.showNotification('Êú¨Âú∞ÁºìÂ≠òÂ∑≤Ê∏ÖÈô§', 'success');
                    setTimeout(() => location.reload(), 1000);
                }
            }
            
            resetProgress() {
                if (confirm('‚ö†Ô∏è Á°ÆÂÆöË¶ÅÈáçÁΩÆÂ≠¶‰π†ËøõÂ∫¶ÂêóÔºü\n\nËøôÂ∞ÜÊ∏ÖÈô§Ôºö\n‚Ä¢ ÊâÄÊúâÂçïËØçÁöÑÁÜüÁªÉÂ∫¶\n‚Ä¢ Â≠¶‰π†ËÆ∞ÂΩï\n‚Ä¢ ÊàêÂ∞±ËøõÂ∫¶\n‚Ä¢ ËøûÁª≠Â≠¶‰π†Â§©Êï∞\n\nÊ≠§Êìç‰Ωú‰∏çÂèØÊí§ÈîÄÔºÅ')) {
                    localStorage.clear();
                    this.showNotification('Â≠¶‰π†ËøõÂ∫¶Â∑≤ÈáçÁΩÆ', 'success');
                    setTimeout(() => {
                        window.location.href = 'index.html';
                    }, 1500);
                }
            }
            
            showModal(content) {
                document.getElementById('modalContent').innerHTML = content;
                document.getElementById('modal').classList.add('active');
            }
            
            closeModal() {
                document.getElementById('modal').classList.remove('active');
            }
            
            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = 'notification';
                
                const iconClass = {
                    success: 'fas fa-check-circle',
                    warning: 'fas fa-exclamation-triangle',
                    info: 'fas fa-info-circle',
                    error: 'fas fa-times-circle'
                }[type] || 'fas fa-info-circle';
                
                const iconColor = {
                    success: 'var(--accent)',
                    warning: '#E6B400',
                    info: 'var(--primary)',
                    error: 'var(--danger)'
                }[type] || 'var(--primary)';
                
                notification.innerHTML = `
                    <div class="notification-icon" style="background: ${iconColor}20; color: ${iconColor};">
                        <i class="${iconClass}"></i>
                    </div>
                    <div style="flex: 1;">
                        <div style="font-weight: 600; margin-bottom: 4px;">ÈÄöÁü•</div>
                        <div style="font-size: 14px; color: var(--gray);">${message}</div>
                    </div>
                    <button class="notification-close">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                document.body.appendChild(notification);
                
                notification.querySelector('.notification-close').addEventListener('click', () => {
                    notification.remove();
                });
                
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.style.opacity = '0';
                        notification.style.transform = 'translateX(100%)';
                        setTimeout(() => {
                            if (notification.parentNode) {
                                notification.remove();
                            }
                        }, 300);
                    }
                }, 5000);
            }
        }
        
        // ÂàùÂßãÂåñÂ∫îÁî®
        const app = new StudentApp();
        window.app = app;
    </script>
</body>
</html>
